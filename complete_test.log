[dotenv@17.2.1] injecting env (14) from .env -- tip: 📡 observe env with Radar: https://dotenvx.com/radar
🚀 Starting Prome Platform server
✅ Dify API environment variables are configured
Server is running on port 8080
🔍 Performing database health check...
✅ Database health check passed - all required tables exist
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=false, query=false, final=false
🔍 Full request body: {
  "message": "你好",
  "user": "final-test-user",
  "stream": false
}
🆕 Generated new conversation UUID: 8c0c9c6f-d468-404c-b4f9-698bc1eaa8a6
🔍 Looking up conversation in database: 8c0c9c6f-d468-404c-b4f9-698bc1eaa8a6
📝 No existing conversation found for: 8c0c9c6f-d468-404c-b4f9-698bc1eaa8a6
🔧 Created new user ID mapping: final-test-user -> 9e745e92-a4e5-4abc-8642-937d12d2a9b9
🆕 Starting new conversation - letting DIFY initialize conversation variables
📤 [DIFY API] Sending request to chat-messages: {
  query: '你好...',
  inputs: {},
  response_mode: 'blocking',
  user: '9e745e92-a4e5-4abc-8642-937d12d2a9b9',
  conversation_id: 'NEW_CONVERSATION',
  timestamp: '2025-08-30T06:15:21.590Z'
}
📊 New conversation, no context management needed
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '9772273aca585bf4-SYD',
  connection: 'keep-alive',
  'content-encoding': 'br',
  'content-type': 'application/json',
  date: 'Sat, 30 Aug 2025 06:15:24 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=F3GtDnp5ys1E%2FYX8wStzMIhHo3WpC0aut37gExhMeQj5TZ63%2F4ZWS9HlOq%2BG35MAG9ViQaDXuDPvJBL52VLt73TfuGunuLtmVDkAo4EqQCG11kBe8QJGLtuLnxvRIqfn1Jq5A8uri8ck"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=6107&min_rtt=3980&rtt_var=5747&sent=6&recv=6&lost=0&retrans=1&sent_bytes=2956&recv_bytes=881&delivery_rate=196625&cwnd=252&unsent_bytes=0&cid=ab8289871a02f11b&ts=2927&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
📥 [DIFY API] Received blocking response: {
  conversation_id: 'b0a71348-8b8b-47ba-91c4-1cdcb6cfeab5',
  message_id: 'e0b5d306-34db-4c04-a4bd-f93d29390a24',
  answer_preview: 'COMPLETENESS: 0  \n您好！请介绍您的产品详情（是什么产品，如何解决用户的问题）。...',
  mode: 'advanced-chat',
  hasMetadata: true,
  hasUsage: true,
  timestamp: '2025-08-30T06:15:24.788Z'
}
✅ Successfully received response from Dify API
🔄 Using existing user ID mapping for: final-test-user
🔍 ensureConversationExists called with: {
  conversationId: 'b0a71348-8b8b-47ba-91c4-1cdcb6cfeab5',
  difyConversationId: 'b0a71348-8b8b-47ba-91c4-1cdcb6cfeab5',
  userId: '9e745e92-a4e5-4abc-8642-937d12d2a9b9',
  hasSupabase: true
}
⚠️ User not found in database, creating conversation without user_id: 9e745e92-a4e5-4abc-8642-937d12d2a9b9
✅ Created new conversation record
✅ Messages saved successfully
📤 [SERVER → FRONTEND] Sending response to frontend: {
  hasAnswer: true,
  answerLength: 48,
  conversation_id: 'b0a71348-8b8b-47ba-91c4-1cdcb6cfeab5',
  message_id: 'e0b5d306-34db-4c04-a4bd-f93d29390a24',
  hasMetadata: true,
  hasUsage: true,
  usageDetails: {
    prompt_tokens: 906,
    completion_tokens: 30,
    total_tokens: 936,
    total_price: '0.002052',
    currency: 'USD'
  },
  metadataKeys: [ 'annotation_reply', 'retriever_resources', 'usage', 'timestamp' ],
  timestamp: '2025-08-30T06:15:25.567Z'
}
🔍 [DEBUG] responseData structure for billing: {
  hasResponseData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 936
}
💰 [BILLING-DIFY_GENERIC] Multi-node LLM: 936 tokens
💰 [COST-DIFY_GENERIC] Actual cost: $0.002052 = 21 points
🔄 Using existing user ID mapping for: final-test-user
⚠️  [BILLING-DIFY_GENERIC] User not found in database: 9e745e92-a4e5-4abc-8642-937d12d2a9b9
💡 [BILLING-DIFY_GENERIC] Creating guest user session for: 9e745e92-a4e5-4abc-8642-937d12d2a9b9
⚠️  [BILLING-DIFY_GENERIC] Guest user - no points deducted, usage recorded only
📝 [BILLING-DIFY_GENERIC] Guest balance updated: 10000 → 9979 (memory only)
🔥 [BLOCKING] Adding balance update to response: 9979
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=false, query=false, final=false
🔍 Full request body: {
  "message": "我的产品是AI助手",
  "user": "final-test-user",
  "conversation_id": "b0a71348-8b8b-47ba-91c4-1cdcb6cfeab5",
  "stream": false
}
🔍 Looking up conversation in database: b0a71348-8b8b-47ba-91c4-1cdcb6cfeab5
✅ Found existing DIFY conversation: b0a71348-8b8b-47ba-91c4-1cdcb6cfeab5
🔄 Using existing user ID mapping for: final-test-user
🔄 Continuing existing conversation: b0a71348-8b8b-47ba-91c4-1cdcb6cfeab5
📤 [DIFY API] Sending request to chat-messages: {
  query: '我的产品是AI助手...',
  inputs: {},
  response_mode: 'blocking',
  user: '9e745e92-a4e5-4abc-8642-937d12d2a9b9',
  conversation_id: 'b0a71348-8b8b-47ba-91c4-1cdcb6cfeab5',
  timestamp: '2025-08-30T06:15:25.838Z'
}
📊 Context check: 52 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '97722755785a5bf4-SYD',
  connection: 'keep-alive',
  'content-encoding': 'br',
  'content-type': 'application/json',
  date: 'Sat, 30 Aug 2025 06:15:28 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=ZrTn0lYh1PzddV3pgXqS%2FNIEucxBZRd44fLxBARCP9v5H6l4A2%2BtUWamufr332v8S8PJrD6ymatIWRqPKsP%2BkrhDwFHJV2lgRPMPOqpBiosv%2Bj5RCoXCVggZWXvgz07G6q7ZzEH8x9c3"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=6126&min_rtt=3980&rtt_var=4348&sent=11&recv=8&lost=0&retrans=1&sent_bytes=4990&recv_bytes=1372&delivery_rate=861479&cwnd=256&unsent_bytes=0&cid=ab8289871a02f11b&ts=6874&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
📥 [DIFY API] Received blocking response: {
  conversation_id: 'b0a71348-8b8b-47ba-91c4-1cdcb6cfeab5',
  message_id: 'c1f2b8b0-2c54-4482-80df-cd93fee3dffe',
  answer_preview: 'COMPLETENESS: 1  \n感谢您的信息！请说明您的AI助手的主要特色和优势（例如：有哪些独特功能，能为用户带来哪些好处）。...',
  mode: 'advanced-chat',
  hasMetadata: true,
  hasUsage: true,
  timestamp: '2025-08-30T06:15:28.736Z'
}
✅ Successfully received response from Dify API
🔄 Using existing user ID mapping for: final-test-user
🔍 ensureConversationExists called with: {
  conversationId: 'b0a71348-8b8b-47ba-91c4-1cdcb6cfeab5',
  difyConversationId: 'b0a71348-8b8b-47ba-91c4-1cdcb6cfeab5',
  userId: '9e745e92-a4e5-4abc-8642-937d12d2a9b9',
  hasSupabase: true
}
✅ Messages saved successfully
📤 [SERVER → FRONTEND] Sending response to frontend: {
  hasAnswer: true,
  answerLength: 66,
  conversation_id: 'b0a71348-8b8b-47ba-91c4-1cdcb6cfeab5',
  message_id: 'c1f2b8b0-2c54-4482-80df-cd93fee3dffe',
  hasMetadata: true,
  hasUsage: true,
  usageDetails: {
    prompt_tokens: 973,
    completion_tokens: 45,
    total_tokens: 1018,
    total_price: '0.002306',
    currency: 'USD'
  },
  metadataKeys: [ 'annotation_reply', 'retriever_resources', 'usage', 'timestamp' ],
  timestamp: '2025-08-30T06:15:29.118Z'
}
🔍 [DEBUG] responseData structure for billing: {
  hasResponseData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 1018
}
💰 [BILLING-DIFY_GENERIC] Multi-node LLM: 1018 tokens
💰 [COST-DIFY_GENERIC] Actual cost: $0.002306 = 24 points
🔄 Using existing user ID mapping for: final-test-user
⚠️  [BILLING-DIFY_GENERIC] User not found in database: 9e745e92-a4e5-4abc-8642-937d12d2a9b9
💡 [BILLING-DIFY_GENERIC] Creating guest user session for: 9e745e92-a4e5-4abc-8642-937d12d2a9b9
⚠️  [BILLING-DIFY_GENERIC] Guest user - no points deducted, usage recorded only
📝 [BILLING-DIFY_GENERIC] Guest balance updated: 9979 → 9955 (memory only)
🔥 [BLOCKING] Adding balance update to response: 9955
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=false, query=false, final=false
🔍 Full request body: {
  "message": "它有什么特色功能",
  "user": "final-test-user",
  "conversation_id": "b0a71348-8b8b-47ba-91c4-1cdcb6cfeab5",
  "stream": false
}
🔍 Looking up conversation in database: b0a71348-8b8b-47ba-91c4-1cdcb6cfeab5
✅ Found existing DIFY conversation: b0a71348-8b8b-47ba-91c4-1cdcb6cfeab5
🔄 Using existing user ID mapping for: final-test-user
🔄 Continuing existing conversation: b0a71348-8b8b-47ba-91c4-1cdcb6cfeab5
📤 [DIFY API] Sending request to chat-messages: {
  query: '它有什么特色功能...',
  inputs: {},
  response_mode: 'blocking',
  user: '9e745e92-a4e5-4abc-8642-937d12d2a9b9',
  conversation_id: 'b0a71348-8b8b-47ba-91c4-1cdcb6cfeab5',
  timestamp: '2025-08-30T06:15:29.411Z'
}
📊 Context check: 122 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '9772276b78c25bf4-SYD',
  connection: 'keep-alive',
  'content-encoding': 'br',
  'content-type': 'application/json',
  date: 'Sat, 30 Aug 2025 06:15:32 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=kNPrnqNW%2FGTcJH%2FmGwlOMA6n5S3tFr1mVi0M0tnl2ALeQ3mOl2EDyCJQylpYMHpcQuxJIVrsmKXfpvS71MAvqY67NMyiz6596OJ2j134oxh6o9SBqFMVUHkAYiVd%2B69LWKaNgwdHxfUh"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=7044&min_rtt=3980&rtt_var=5098&sent=14&recv=10&lost=0&retrans=1&sent_bytes=6591&recv_bytes=1864&delivery_rate=861479&cwnd=256&unsent_bytes=0&cid=ab8289871a02f11b&ts=10912&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
📥 [DIFY API] Received blocking response: {
  conversation_id: 'b0a71348-8b8b-47ba-91c4-1cdcb6cfeab5',
  message_id: '7f3f3527-4a89-4478-9b6f-4336cc8c019a',
  answer_preview: 'COMPLETENESS: 1  \n' +
    '目前还没有收到关于您产品的特色功能描述。请您介绍一下您的AI助手有哪些主要特色和优势（例如：是否支持多语言、能否自动完成某些任务、个性化推荐等）。...',
  mode: 'advanced-chat',
  hasMetadata: true,
  hasUsage: true,
  timestamp: '2025-08-30T06:15:32.768Z'
}
✅ Successfully received response from Dify API
🔄 Using existing user ID mapping for: final-test-user
🔍 ensureConversationExists called with: {
  conversationId: 'b0a71348-8b8b-47ba-91c4-1cdcb6cfeab5',
  difyConversationId: 'b0a71348-8b8b-47ba-91c4-1cdcb6cfeab5',
  userId: '9e745e92-a4e5-4abc-8642-937d12d2a9b9',
  hasSupabase: true
}
✅ Messages saved successfully
📤 [SERVER → FRONTEND] Sending response to frontend: {
  hasAnswer: true,
  answerLength: 91,
  conversation_id: 'b0a71348-8b8b-47ba-91c4-1cdcb6cfeab5',
  message_id: '7f3f3527-4a89-4478-9b6f-4336cc8c019a',
  hasMetadata: true,
  hasUsage: true,
  usageDetails: {
    prompt_tokens: 1054,
    completion_tokens: 60,
    total_tokens: 1114,
    total_price: '0.002588',
    currency: 'USD'
  },
  metadataKeys: [ 'annotation_reply', 'retriever_resources', 'usage', 'timestamp' ],
  timestamp: '2025-08-30T06:15:33.142Z'
}
🔍 [DEBUG] responseData structure for billing: {
  hasResponseData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 1114
}
💰 [BILLING-DIFY_GENERIC] Multi-node LLM: 1114 tokens
💰 [COST-DIFY_GENERIC] Actual cost: $0.002588 = 26 points
🔄 Using existing user ID mapping for: final-test-user
⚠️  [BILLING-DIFY_GENERIC] User not found in database: 9e745e92-a4e5-4abc-8642-937d12d2a9b9
💡 [BILLING-DIFY_GENERIC] Creating guest user session for: 9e745e92-a4e5-4abc-8642-937d12d2a9b9
⚠️  [BILLING-DIFY_GENERIC] Guest user - no points deducted, usage recorded only
📝 [BILLING-DIFY_GENERIC] Guest balance updated: 9955 → 9929 (memory only)
🔥 [BLOCKING] Adding balance update to response: 9929
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "你好",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "conversation_id": "b0e0e191-2b35-4c5d-b934-4649d367c4d1",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🔍 Looking up conversation in database: b0e0e191-2b35-4c5d-b934-4649d367c4d1
✅ Found existing DIFY conversation: b0e0e191-2b35-4c5d-b934-4649d367c4d1
🔄 Continuing existing conversation: b0e0e191-2b35-4c5d-b934-4649d367c4d1
📤 [DIFY API] Sending request to chat-messages: {
  query: '你好...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: 'b0e0e191-2b35-4c5d-b934-4649d367c4d1',
  timestamp: '2025-08-30T06:16:22.760Z'
}
📊 Context check: 411 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '977228b95dd2c8dc-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sat, 30 Aug 2025 06:16:24 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=vSSw4dPxLtLBjqn0%2B9F%2BZJZIl4gohH1WZ2ZHsslus6cET4CRBy5%2FPDSajTVsKPoULIstB56EHfE4Fdese47gbsxxuvDd7BoBfWtz97HoSZllYI%2BaofU0xyouSopi2lm6A99Kt2DZ4EO4"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=4629&min_rtt=3946&rtt_var=2846&sent=3&recv=5&lost=0&retrans=0&sent_bytes=234&recv_bytes=1210&delivery_rate=143206&cwnd=250&unsent_bytes=0&cid=7cfa96949ec179cd&ts=971&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: 'b0e0e191-2b35-4c5d-b934-4649d367c4d1',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'b0e0e191-2b35-4c5d-b934-4649d367c4d1',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'b0e0e191-2b35-4c5d-b934-4649d367c4d1',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'b0e0e191-2b35-4c5d-b934-4649d367c4d1',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'b0e0e191-2b35-4c5d-b934-4649d367c4d1',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'b0e0e191-2b35-4c5d-b934-4649d367c4d1',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'b0e0e191-2b35-4c5d-b934-4649d367c4d1',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'b0e0e191-2b35-4c5d-b934-4649d367c4d1',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'b0e0e191-2b35-4c5d-b934-4649d367c4d1',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'b0e0e191-2b35-4c5d-b934-4649d367c4d1',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'b0e0e191-2b35-4c5d-b934-4649d367c4d1',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'b0e0e191-2b35-4c5d-b934-4649d367c4d1',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'b0e0e191-2b35-4c5d-b934-4649d367c4d1',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'b0e0e191-2b35-4c5d-b934-4649d367c4d1',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'b0e0e191-2b35-4c5d-b934-4649d367c4d1',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'b0e0e191-2b35-4c5d-b934-4649d367c4d1',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'b0e0e191-2b35-4c5d-b934-4649d367c4d1',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'b0e0e191-2b35-4c5d-b934-4649d367c4d1',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'b0e0e191-2b35-4c5d-b934-4649d367c4d1',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'b0e0e191-2b35-4c5d-b934-4649d367c4d1',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'b0e0e191-2b35-4c5d-b934-4649d367c4d1',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'b0e0e191-2b35-4c5d-b934-4649d367c4d1',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'b0e0e191-2b35-4c5d-b934-4649d367c4d1',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'b0e0e191-2b35-4c5d-b934-4649d367c4d1',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'b0e0e191-2b35-4c5d-b934-4649d367c4d1',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'b0e0e191-2b35-4c5d-b934-4649d367c4d1',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'b0e0e191-2b35-4c5d-b934-4649d367c4d1',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'b0e0e191-2b35-4c5d-b934-4649d367c4d1',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'b0e0e191-2b35-4c5d-b934-4649d367c4d1',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'b0e0e191-2b35-4c5d-b934-4649d367c4d1',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: 'b0e0e191-2b35-4c5d-b934-4649d367c4d1',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'b0e0e191-2b35-4c5d-b934-4649d367c4d1',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'b0e0e191-2b35-4c5d-b934-4649d367c4d1',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'b0e0e191-2b35-4c5d-b934-4649d367c4d1',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'b0e0e191-2b35-4c5d-b934-4649d367c4d1',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'b0e0e191-2b35-4c5d-b934-4649d367c4d1',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'b0e0e191-2b35-4c5d-b934-4649d367c4d1',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'b0e0e191-2b35-4c5d-b934-4649d367c4d1',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'b0e0e191-2b35-4c5d-b934-4649d367c4d1',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'b0e0e191-2b35-4c5d-b934-4649d367c4d1',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'b0e0e191-2b35-4c5d-b934-4649d367c4d1',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'b0e0e191-2b35-4c5d-b934-4649d367c4d1',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: 'b0e0e191-2b35-4c5d-b934-4649d367c4d1',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: 'b0e0e191-2b35-4c5d-b934-4649d367c4d1',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 1682
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 1682 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.003532 = 36 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 36 points. Balance: 5744 → 5708
🔥 [STREAM] Sending balance update to frontend: 5708
🔍 ensureConversationExists called with: {
  conversationId: 'b0e0e191-2b35-4c5d-b934-4649d367c4d1',
  difyConversationId: 'b0e0e191-2b35-4c5d-b934-4649d367c4d1',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "你好",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🆕 Generated new conversation UUID: 43dd9103-8bde-4ea9-b019-54fc134b2fb8
🔍 Looking up conversation in database: 43dd9103-8bde-4ea9-b019-54fc134b2fb8
📝 No existing conversation found for: 43dd9103-8bde-4ea9-b019-54fc134b2fb8
🆕 Starting new conversation - letting DIFY initialize conversation variables
📤 [DIFY API] Sending request to chat-messages: {
  query: '你好...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: 'NEW_CONVERSATION',
  timestamp: '2025-08-30T06:18:40.592Z'
}
📊 New conversation, no context management needed
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '97722c169b3ddb45-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sat, 30 Aug 2025 06:18:42 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=PGXB06dBw7%2B2LmTyHxYrh%2FAMpCGrJmEcIEFsFcSGvshV%2BjKmts4hIbIBiJYSGXRMM6Af2TBy19OqPcDfaKIspGdSbg5LtDV%2FkNXHzWM49u%2B7iHyGFQXQ5WZucByu6H4aPzz4mxU6LCDW"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=3856&min_rtt=3538&rtt_var=1554&sent=3&recv=5&lost=0&retrans=0&sent_bytes=234&recv_bytes=1153&delivery_rate=381006&cwnd=250&unsent_bytes=0&cid=92aa5112685ece2a&ts=1091&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 942
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 942 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.002076 = 21 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 21 points. Balance: 5708 → 5687
🔥 [STREAM] Sending balance update to frontend: 5687
🔍 ensureConversationExists called with: {
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  difyConversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Verified user exists in database: 9dee4891-89a6-44ee-8fe8-69097846e97d
✅ Created new conversation record
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "你好",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "conversation_id": "15406ffc-a242-48ac-b876-2361e191587a",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🔍 Looking up conversation in database: 15406ffc-a242-48ac-b876-2361e191587a
✅ Found existing DIFY conversation: 15406ffc-a242-48ac-b876-2361e191587a
🔄 Continuing existing conversation: 15406ffc-a242-48ac-b876-2361e191587a
📤 [DIFY API] Sending request to chat-messages: {
  query: '你好...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: '15406ffc-a242-48ac-b876-2361e191587a',
  timestamp: '2025-08-30T06:18:48.341Z'
}
📊 Context check: 20 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '97722c472ac7e7ea-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sat, 30 Aug 2025 06:18:49 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=2zSQ7t8EVSCrV08n3cbdrbyuYTXv6ahQAi8mnXuPJB6afeQHichV%2FpoY19Lsvk%2FZYnj%2FBnRpoAo3t3AhE%2BZUILkDgunEPoSV4lk0n5GqMxoGZCimcZ%2BOwtYRVF4J9zT146DSVVgi7bDG"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=4898&min_rtt=3490&rtt_var=2315&sent=3&recv=5&lost=0&retrans=0&sent_bytes=234&recv_bytes=1210&delivery_rate=386246&cwnd=244&unsent_bytes=0&cid=58e4ef272351ea81&ts=608&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 977
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 977 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.002146 = 22 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 22 points. Balance: 5687 → 5665
🔥 [STREAM] Sending balance update to frontend: 5665
🔍 ensureConversationExists called with: {
  conversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  difyConversationId: '15406ffc-a242-48ac-b876-2361e191587a',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=false, query=false, final=false
🔍 Full request body: {
  "message": "测试计费功能",
  "user": "test-final-billing-user",
  "stream": false
}
🆕 Generated new conversation UUID: 974590d0-150d-4a49-af27-1906c06ecd1d
🔍 Looking up conversation in database: 974590d0-150d-4a49-af27-1906c06ecd1d
📝 No existing conversation found for: 974590d0-150d-4a49-af27-1906c06ecd1d
🔧 Created new user ID mapping: test-final-billing-user -> f85cac1e-8969-418e-8c80-4aaa35fc0590
🆕 Starting new conversation - letting DIFY initialize conversation variables
📤 [DIFY API] Sending request to chat-messages: {
  query: '测试计费功能...',
  inputs: {},
  response_mode: 'blocking',
  user: 'f85cac1e-8969-418e-8c80-4aaa35fc0590',
  conversation_id: 'NEW_CONVERSATION',
  timestamp: '2025-08-30T14:18:14.569Z'
}
📊 New conversation, no context management needed
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '9774ea95fed8344e-SYD',
  connection: 'keep-alive',
  'content-encoding': 'br',
  'content-type': 'application/json',
  date: 'Sat, 30 Aug 2025 14:18:21 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=n%2F%2BHyKK%2B4%2F8ae5Bz3E%2FbuDDBcyzcRbV%2BQWclLYrhFagREC9RqSNDJNQkA0x0VJnbQ4Rgm19RJCgT%2FTH2J3qIqS9%2BsFigNnqmnV0vArrQHZgsA%2F00AXPAZYZDHNg3HF3byHSgryoRK6lb"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=3992&min_rtt=3991&rtt_var=1500&sent=3&recv=5&lost=0&retrans=0&sent_bytes=234&recv_bytes=1164&delivery_rate=336663&cwnd=246&unsent_bytes=0&cid=77f53158554c7ddc&ts=5766&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
📥 [DIFY API] Received blocking response: {
  conversation_id: 'ae9cb317-aab4-494d-8085-326bfda5bba9',
  message_id: '1001bd03-1355-44c2-8325-899144b3ce1f',
  answer_preview: 'COMPLETENESS: 1\n请介绍您的产品的主要特色（主要优势和亮点）。...',
  mode: 'advanced-chat',
  hasMetadata: true,
  hasUsage: true,
  timestamp: '2025-08-30T14:18:21.076Z'
}
✅ Successfully received response from Dify API
🔄 Using existing user ID mapping for: test-final-billing-user
🔍 ensureConversationExists called with: {
  conversationId: 'ae9cb317-aab4-494d-8085-326bfda5bba9',
  difyConversationId: 'ae9cb317-aab4-494d-8085-326bfda5bba9',
  userId: 'f85cac1e-8969-418e-8c80-4aaa35fc0590',
  hasSupabase: true
}
⚠️ User not found in database, creating conversation without user_id: f85cac1e-8969-418e-8c80-4aaa35fc0590
✅ Created new conversation record
✅ Messages saved successfully
📤 [SERVER → FRONTEND] Sending response to frontend: {
  hasAnswer: true,
  answerLength: 38,
  conversation_id: 'ae9cb317-aab4-494d-8085-326bfda5bba9',
  message_id: '1001bd03-1355-44c2-8325-899144b3ce1f',
  hasMetadata: true,
  hasUsage: true,
  usageDetails: {
    prompt_tokens: 905,
    completion_tokens: 28,
    total_tokens: 933,
    total_price: '0.002034',
    currency: 'USD'
  },
  metadataKeys: [ 'annotation_reply', 'retriever_resources', 'usage', 'timestamp' ],
  timestamp: '2025-08-30T14:18:22.353Z'
}
🔍 [DEBUG] responseData structure for billing: {
  hasResponseData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 933
}
💰 [BILLING-DIFY_GENERIC] Multi-node LLM: 933 tokens
💰 [COST-DIFY_GENERIC] Actual cost: $0.002034 = 21 points
🔄 Using existing user ID mapping for: test-final-billing-user
⚠️  [BILLING-DIFY_GENERIC] User not found in database: f85cac1e-8969-418e-8c80-4aaa35fc0590
💡 [BILLING-DIFY_GENERIC] Creating guest user session for: f85cac1e-8969-418e-8c80-4aaa35fc0590
⚠️  [BILLING-DIFY_GENERIC] Guest user - no points deducted, usage recorded only
📝 [BILLING-DIFY_GENERIC] Guest balance updated: 10000 → 9979 (memory only)
🔥 [BLOCKING] Adding balance update to response: 9979
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=false, query=false, final=false
🔍 Full request body: {
  "message": "测试计费功能",
  "user": "test-final-billing-user",
  "stream": false
}
🆕 Generated new conversation UUID: c2d779c2-ccb9-433e-8060-0978ee7225fd
🔍 Looking up conversation in database: c2d779c2-ccb9-433e-8060-0978ee7225fd
📝 No existing conversation found for: c2d779c2-ccb9-433e-8060-0978ee7225fd
🔄 Using existing user ID mapping for: test-final-billing-user
🆕 Starting new conversation - letting DIFY initialize conversation variables
📤 [DIFY API] Sending request to chat-messages: {
  query: '测试计费功能...',
  inputs: {},
  response_mode: 'blocking',
  user: 'f85cac1e-8969-418e-8c80-4aaa35fc0590',
  conversation_id: 'NEW_CONVERSATION',
  timestamp: '2025-08-30T14:18:57.237Z'
}
📊 New conversation, no context management needed
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '9774eba05b4a97c5-SYD',
  connection: 'keep-alive',
  'content-encoding': 'br',
  'content-type': 'application/json',
  date: 'Sat, 30 Aug 2025 14:19:02 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=aJ3t%2BiPpSenKTo1Ei2%2BDJ651uOtLEXtplsT4W4kZPhWIbqTWNUl8UD5iIJd6XYyb2QmORuxK9MLvyIh9HCsmQTmEKGvYPjVoEfxsz1Q2Jh4MghUW1J0H%2BR8jVPIJsZa%2FHdwqPnIrcPuV"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=6452&min_rtt=4987&rtt_var=3943&sent=5&recv=6&lost=0&retrans=0&sent_bytes=2827&recv_bytes=893&delivery_rate=359690&cwnd=252&unsent_bytes=0&cid=ce8264c56381ac55&ts=4423&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
📥 [DIFY API] Received blocking response: {
  conversation_id: 'd645ab46-9920-4396-83cc-272abe965544',
  message_id: 'c4ad8e4f-c9a9-4d89-94bf-cc5796611975',
  answer_preview: 'COMPLETENESS: 1\n\n您提到“测试计费功能”，我理解这是您的产品类型。请补充下一个信息：请说明产品的主要特色（优势和亮点）。...',
  mode: 'advanced-chat',
  hasMetadata: true,
  hasUsage: true,
  timestamp: '2025-08-30T14:19:02.448Z'
}
✅ Successfully received response from Dify API
🔄 Using existing user ID mapping for: test-final-billing-user
🔍 ensureConversationExists called with: {
  conversationId: 'd645ab46-9920-4396-83cc-272abe965544',
  difyConversationId: 'd645ab46-9920-4396-83cc-272abe965544',
  userId: 'f85cac1e-8969-418e-8c80-4aaa35fc0590',
  hasSupabase: true
}
⚠️ User not found in database, creating conversation without user_id: f85cac1e-8969-418e-8c80-4aaa35fc0590
✅ Created new conversation record
✅ Messages saved successfully
📤 [SERVER → FRONTEND] Sending response to frontend: {
  hasAnswer: true,
  answerLength: 68,
  conversation_id: 'd645ab46-9920-4396-83cc-272abe965544',
  message_id: 'c4ad8e4f-c9a9-4d89-94bf-cc5796611975',
  hasMetadata: true,
  hasUsage: true,
  usageDetails: {
    prompt_tokens: 947,
    completion_tokens: 49,
    total_tokens: 996,
    total_price: '0.002286',
    currency: 'USD'
  },
  metadataKeys: [ 'annotation_reply', 'retriever_resources', 'usage', 'timestamp' ],
  timestamp: '2025-08-30T14:19:03.415Z'
}
🔍 [DEBUG] responseData structure for billing: {
  hasResponseData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 996
}
💰 [BILLING-DIFY_GENERIC] Multi-node LLM: 996 tokens
💰 [COST-DIFY_GENERIC] Actual cost: $0.002286 = 23 points
🔄 Using existing user ID mapping for: test-final-billing-user
⚠️  [BILLING-DIFY_GENERIC] User not found in database: f85cac1e-8969-418e-8c80-4aaa35fc0590
💡 [BILLING-DIFY_GENERIC] Creating guest user session for: f85cac1e-8969-418e-8c80-4aaa35fc0590
⚠️  [BILLING-DIFY_GENERIC] Guest user - no points deducted, usage recorded only
📝 [BILLING-DIFY_GENERIC] Guest balance updated: 9979 → 9956 (memory only)
🔥 [BLOCKING] Adding balance update to response: 9956
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=false, query=false, final=false
🔍 Full request body: {
  "message": "第二次测试",
  "user": "test-final-billing-user",
  "stream": false
}
🆕 Generated new conversation UUID: 69b10ee9-56e6-4696-8847-c6ddb1f9bd24
🔍 Looking up conversation in database: 69b10ee9-56e6-4696-8847-c6ddb1f9bd24
📝 No existing conversation found for: 69b10ee9-56e6-4696-8847-c6ddb1f9bd24
🔄 Using existing user ID mapping for: test-final-billing-user
🆕 Starting new conversation - letting DIFY initialize conversation variables
📤 [DIFY API] Sending request to chat-messages: {
  query: '第二次测试...',
  inputs: {},
  response_mode: 'blocking',
  user: 'f85cac1e-8969-418e-8c80-4aaa35fc0590',
  conversation_id: 'NEW_CONVERSATION',
  timestamp: '2025-08-30T14:58:44.437Z'
}
📊 New conversation, no context management needed
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '977525e97dd5e7e4-SYD',
  connection: 'keep-alive',
  'content-encoding': 'br',
  'content-type': 'application/json',
  date: 'Sat, 30 Aug 2025 14:58:51 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=Ot8VkFqnIfeVo4Wxab1FnAiL8ULDxgPQbZnzUhFzZ4O3b41fGuJZJoP17qQ30SUT%2FbUkJd6ct0tFRdMOf76MCdIiqkZPTW%2FdO2piELCl9mtOQjnBkKipgmyZR%2FIopF36zSOtzMEL66sc"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=32036&min_rtt=4444&rtt_var=18412&sent=3&recv=5&lost=0&retrans=0&sent_bytes=234&recv_bytes=1161&delivery_rate=303330&cwnd=244&unsent_bytes=0&cid=32f1d3093f51ec25&ts=6254&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
📥 [DIFY API] Received blocking response: {
  conversation_id: '5cbe2163-15c6-4af7-8e18-7b44a3a7d8fc',
  message_id: '81c666b3-7aa0-4413-ad3e-89cf72a878dd',
  answer_preview: 'COMPLETENESS: 0\n请介绍您的产品详情（是什么产品，如何解决问题）...',
  mode: 'advanced-chat',
  hasMetadata: true,
  hasUsage: true,
  timestamp: '2025-08-30T14:58:51.634Z'
}
✅ Successfully received response from Dify API
🔄 Using existing user ID mapping for: test-final-billing-user
🔍 ensureConversationExists called with: {
  conversationId: '5cbe2163-15c6-4af7-8e18-7b44a3a7d8fc',
  difyConversationId: '5cbe2163-15c6-4af7-8e18-7b44a3a7d8fc',
  userId: 'f85cac1e-8969-418e-8c80-4aaa35fc0590',
  hasSupabase: true
}
⚠️ User not found in database, creating conversation without user_id: f85cac1e-8969-418e-8c80-4aaa35fc0590
✅ Created new conversation record
✅ Messages saved successfully
📤 [SERVER → FRONTEND] Sending response to frontend: {
  hasAnswer: true,
  answerLength: 39,
  conversation_id: '5cbe2163-15c6-4af7-8e18-7b44a3a7d8fc',
  message_id: '81c666b3-7aa0-4413-ad3e-89cf72a878dd',
  hasMetadata: true,
  hasUsage: true,
  usageDetails: {
    prompt_tokens: 902,
    completion_tokens: 27,
    total_tokens: 929,
    total_price: '0.00202',
    currency: 'USD'
  },
  metadataKeys: [ 'annotation_reply', 'retriever_resources', 'usage', 'timestamp' ],
  timestamp: '2025-08-30T14:58:53.761Z'
}
🔍 [DEBUG] responseData structure for billing: {
  hasResponseData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 929
}
💰 [BILLING-DIFY_GENERIC] Multi-node LLM: 929 tokens
💰 [COST-DIFY_GENERIC] Actual cost: $0.002020 = 21 points
🔄 Using existing user ID mapping for: test-final-billing-user
⚠️  [BILLING-DIFY_GENERIC] User not found in database: f85cac1e-8969-418e-8c80-4aaa35fc0590
💡 [BILLING-DIFY_GENERIC] Creating guest user session for: f85cac1e-8969-418e-8c80-4aaa35fc0590
⚠️  [BILLING-DIFY_GENERIC] Guest user - no points deducted, usage recorded only
📝 [BILLING-DIFY_GENERIC] Guest balance updated: 9956 → 9935 (memory only)
🔥 [BLOCKING] Adding balance update to response: 9935
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=false, query=false, final=false
🔍 Full request body: {
  "message": "第三次测试连续对话",
  "user": "test-final-billing-user",
  "conversation_id": "5cbe2163-15c6-4af7-8e18-7b44a3a7d8fc",
  "stream": false
}
🔍 Looking up conversation in database: 5cbe2163-15c6-4af7-8e18-7b44a3a7d8fc
✅ Found existing DIFY conversation: 5cbe2163-15c6-4af7-8e18-7b44a3a7d8fc
🔄 Using existing user ID mapping for: test-final-billing-user
🔄 Continuing existing conversation: 5cbe2163-15c6-4af7-8e18-7b44a3a7d8fc
📤 [DIFY API] Sending request to chat-messages: {
  query: '第三次测试连续对话...',
  inputs: {},
  response_mode: 'blocking',
  user: 'f85cac1e-8969-418e-8c80-4aaa35fc0590',
  conversation_id: '5cbe2163-15c6-4af7-8e18-7b44a3a7d8fc',
  timestamp: '2025-08-30T15:02:32.003Z'
}
📊 Context check: 50 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '97752b70cfb2aaed-SYD',
  connection: 'keep-alive',
  'content-encoding': 'br',
  'content-type': 'application/json',
  date: 'Sat, 30 Aug 2025 15:02:34 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=fEK2J9LHGN%2FCHMJCh8MHBQrOdz8b5202SzphBTTqJX%2F%2F0H7K0%2FRPsj7U3lfxuz0EivEvGXIb4b5PwGbk0VQhmg9dGUnhBXwrf3rVkawuR3%2FS7n4YXUwqhPvgbBY%2FnTTXsN1dS8Kxo0%2FA"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=3928&min_rtt=3656&rtt_var=1565&sent=3&recv=5&lost=0&retrans=0&sent_bytes=234&recv_bytes=1230&delivery_rate=368708&cwnd=250&unsent_bytes=0&cid=234c7d77281029f8&ts=2881&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
📥 [DIFY API] Received blocking response: {
  conversation_id: '5cbe2163-15c6-4af7-8e18-7b44a3a7d8fc',
  message_id: 'b880a33c-073a-49c6-bdbb-fff72632f4dc',
  answer_preview: 'COMPLETENESS: 0\n请介绍您的产品详情（是什么产品，如何解决问题）...',
  mode: 'advanced-chat',
  hasMetadata: true,
  hasUsage: true,
  timestamp: '2025-08-30T15:02:34.746Z'
}
✅ Successfully received response from Dify API
🔄 Using existing user ID mapping for: test-final-billing-user
🔍 ensureConversationExists called with: {
  conversationId: '5cbe2163-15c6-4af7-8e18-7b44a3a7d8fc',
  difyConversationId: '5cbe2163-15c6-4af7-8e18-7b44a3a7d8fc',
  userId: 'f85cac1e-8969-418e-8c80-4aaa35fc0590',
  hasSupabase: true
}
✅ Messages saved successfully
📤 [SERVER → FRONTEND] Sending response to frontend: {
  hasAnswer: true,
  answerLength: 39,
  conversation_id: '5cbe2163-15c6-4af7-8e18-7b44a3a7d8fc',
  message_id: 'b880a33c-073a-49c6-bdbb-fff72632f4dc',
  hasMetadata: true,
  hasUsage: true,
  usageDetails: {
    prompt_tokens: 937,
    completion_tokens: 27,
    total_tokens: 964,
    total_price: '0.00209',
    currency: 'USD'
  },
  metadataKeys: [ 'annotation_reply', 'retriever_resources', 'usage', 'timestamp' ],
  timestamp: '2025-08-30T15:02:35.393Z'
}
🔍 [DEBUG] responseData structure for billing: {
  hasResponseData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 964
}
💰 [BILLING-DIFY_GENERIC] Multi-node LLM: 964 tokens
💰 [COST-DIFY_GENERIC] Actual cost: $0.002090 = 21 points
🔄 Using existing user ID mapping for: test-final-billing-user
⚠️  [BILLING-DIFY_GENERIC] User not found in database: f85cac1e-8969-418e-8c80-4aaa35fc0590
💡 [BILLING-DIFY_GENERIC] Creating guest user session for: f85cac1e-8969-418e-8c80-4aaa35fc0590
⚠️  [BILLING-DIFY_GENERIC] Guest user - no points deducted, usage recorded only
📝 [BILLING-DIFY_GENERIC] Guest balance updated: 9935 → 9914 (memory only)
🔥 [BLOCKING] Adding balance update to response: 9914
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "message": "测试流式响应计费",
  "user": "test-stream-billing",
  "stream": true
}
🆕 Generated new conversation UUID: 5fa1e5f6-a22a-4eaf-8551-e4113bcbc9d8
🔍 Looking up conversation in database: 5fa1e5f6-a22a-4eaf-8551-e4113bcbc9d8
📝 No existing conversation found for: 5fa1e5f6-a22a-4eaf-8551-e4113bcbc9d8
🔧 Created new user ID mapping: test-stream-billing -> 724005df-beb0-4de1-b7dd-ad359264e444
🆕 Starting new conversation - letting DIFY initialize conversation variables
📤 [DIFY API] Sending request to chat-messages: {
  query: '测试流式响应计费...',
  inputs: {},
  response_mode: 'streaming',
  user: '724005df-beb0-4de1-b7dd-ad359264e444',
  conversation_id: 'NEW_CONVERSATION',
  timestamp: '2025-08-30T15:03:06.273Z'
}
📊 New conversation, no context management needed
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '97752c4d2fa45729-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sat, 30 Aug 2025 15:03:07 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=oNY0%2BA5MYS9ntkIQDCe1yh4fSFhabWrFU9j%2BuyZbcmpRD%2Bmbi1a4I3P5TqiSQ00mpdq0aDmiOM0TZcrzdjZ%2FB6YfsuPzabGkCuxbZ2XJIx4hl9OCYznOBI6tB6LRf1jT6I4E%2FJ8FbHA2"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=5761&min_rtt=3981&rtt_var=2764&sent=3&recv=5&lost=0&retrans=0&sent_bytes=234&recv_bytes=1171&delivery_rate=338608&cwnd=250&unsent_bytes=0&cid=77b8eae2e5ea6190&ts=741&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: '6869743f-11d1-4381-8f1a-0c10db362c41',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '6869743f-11d1-4381-8f1a-0c10db362c41',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '6869743f-11d1-4381-8f1a-0c10db362c41',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '6869743f-11d1-4381-8f1a-0c10db362c41',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '6869743f-11d1-4381-8f1a-0c10db362c41',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '6869743f-11d1-4381-8f1a-0c10db362c41',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '6869743f-11d1-4381-8f1a-0c10db362c41',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '6869743f-11d1-4381-8f1a-0c10db362c41',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '6869743f-11d1-4381-8f1a-0c10db362c41',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '6869743f-11d1-4381-8f1a-0c10db362c41',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '6869743f-11d1-4381-8f1a-0c10db362c41',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '6869743f-11d1-4381-8f1a-0c10db362c41',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '6869743f-11d1-4381-8f1a-0c10db362c41',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '6869743f-11d1-4381-8f1a-0c10db362c41',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '6869743f-11d1-4381-8f1a-0c10db362c41',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '6869743f-11d1-4381-8f1a-0c10db362c41',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '6869743f-11d1-4381-8f1a-0c10db362c41',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '6869743f-11d1-4381-8f1a-0c10db362c41',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '6869743f-11d1-4381-8f1a-0c10db362c41',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '6869743f-11d1-4381-8f1a-0c10db362c41',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '6869743f-11d1-4381-8f1a-0c10db362c41',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '6869743f-11d1-4381-8f1a-0c10db362c41',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '6869743f-11d1-4381-8f1a-0c10db362c41',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '6869743f-11d1-4381-8f1a-0c10db362c41',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '6869743f-11d1-4381-8f1a-0c10db362c41',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '6869743f-11d1-4381-8f1a-0c10db362c41',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '6869743f-11d1-4381-8f1a-0c10db362c41',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '6869743f-11d1-4381-8f1a-0c10db362c41',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '6869743f-11d1-4381-8f1a-0c10db362c41',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: '6869743f-11d1-4381-8f1a-0c10db362c41',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '6869743f-11d1-4381-8f1a-0c10db362c41',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: '6869743f-11d1-4381-8f1a-0c10db362c41',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '6869743f-11d1-4381-8f1a-0c10db362c41',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: '6869743f-11d1-4381-8f1a-0c10db362c41',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '6869743f-11d1-4381-8f1a-0c10db362c41',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '6869743f-11d1-4381-8f1a-0c10db362c41',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: '6869743f-11d1-4381-8f1a-0c10db362c41',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '6869743f-11d1-4381-8f1a-0c10db362c41',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '6869743f-11d1-4381-8f1a-0c10db362c41',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '6869743f-11d1-4381-8f1a-0c10db362c41',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: '6869743f-11d1-4381-8f1a-0c10db362c41',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: '6869743f-11d1-4381-8f1a-0c10db362c41',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: '6869743f-11d1-4381-8f1a-0c10db362c41',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 932
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 932 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.002026 = 21 points
🔄 Using existing user ID mapping for: test-stream-billing
⚠️  [BILLING-WORKFLOW_STREAM] User not found in database: 724005df-beb0-4de1-b7dd-ad359264e444
💡 [BILLING-WORKFLOW_STREAM] Creating guest user session for: 724005df-beb0-4de1-b7dd-ad359264e444
⚠️  [BILLING-WORKFLOW_STREAM] Guest user - no points deducted, usage recorded only
📝 [BILLING-WORKFLOW_STREAM] Guest balance updated: 10000 → 9979 (memory only)
🔥 [STREAM] Sending balance update to frontend: 9979
🔄 Using existing user ID mapping for: test-stream-billing
🔍 ensureConversationExists called with: {
  conversationId: '6869743f-11d1-4381-8f1a-0c10db362c41',
  difyConversationId: '6869743f-11d1-4381-8f1a-0c10db362c41',
  userId: '724005df-beb0-4de1-b7dd-ad359264e444',
  hasSupabase: true
}
⚠️ User not found in database, creating conversation without user_id: 724005df-beb0-4de1-b7dd-ad359264e444
✅ Created new conversation record
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "nah",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🆕 Generated new conversation UUID: 89c86309-8297-4c57-8f5e-33031965307e
🔍 Looking up conversation in database: 89c86309-8297-4c57-8f5e-33031965307e
📝 No existing conversation found for: 89c86309-8297-4c57-8f5e-33031965307e
🆕 Starting new conversation - letting DIFY initialize conversation variables
📤 [DIFY API] Sending request to chat-messages: {
  query: 'nah...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: 'NEW_CONVERSATION',
  timestamp: '2025-08-30T15:06:10.507Z'
}
📊 New conversation, no context management needed
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '977530c999145c0a-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sat, 30 Aug 2025 15:06:11 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=i2%2BQ9%2FbYrBavKxOHjGK%2BJ8s%2FHWfH5XE8c2VQT7LS7m89GM6drZl5nhy%2FCvR3YQbsn72x3pWLofmknohobiAfwWEJcg%2F31nV%2Fp3N9TkVHqZq0h2kM5Ah7fqqqCkHJrRdmUEkzuzDEVjBL"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=3934&min_rtt=3796&rtt_var=1522&sent=3&recv=5&lost=0&retrans=0&sent_bytes=234&recv_bytes=1150&delivery_rate=355110&cwnd=250&unsent_bytes=0&cid=c394dc61893137ac&ts=1187&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 927
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 927 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.002016 = 21 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 21 points. Balance: 5638 → 5617
🔥 [STREAM] Sending balance update to frontend: 5617
🔍 ensureConversationExists called with: {
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  difyConversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Verified user exists in database: 9dee4891-89a6-44ee-8fe8-69097846e97d
✅ Created new conversation record
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "nah",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "conversation_id": "ea6c918e-a626-4966-97e5-81a88971fc06",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🔍 Looking up conversation in database: ea6c918e-a626-4966-97e5-81a88971fc06
✅ Found existing DIFY conversation: ea6c918e-a626-4966-97e5-81a88971fc06
🔄 Continuing existing conversation: ea6c918e-a626-4966-97e5-81a88971fc06
📤 [DIFY API] Sending request to chat-messages: {
  query: 'nah...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  timestamp: '2025-08-30T15:06:21.117Z'
}
📊 Context check: 16 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '9775310bbca2d5d2-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sat, 30 Aug 2025 15:06:22 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=pByUaJP9WW5lxEJ9l88E9HVVry34zW7USdYiS9Z5i%2BRAL7tjnyC4Iq4k5GQtycNPO%2F9NyZLl6%2Bv985snmkJyTmuwcFpT7RkX6ZUUFI7vy3d0QTySoFMiCy7Qfkd0xjRb1vhY5GPCvbso"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=3880&min_rtt=3184&rtt_var=1691&sent=3&recv=5&lost=0&retrans=0&sent_bytes=234&recv_bytes=1207&delivery_rate=423366&cwnd=250&unsent_bytes=0&cid=11b6a9ace3f42b42&ts=657&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 957
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 957 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.002076 = 21 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 21 points. Balance: 5617 → 5596
🔥 [STREAM] Sending balance update to frontend: 5596
🔍 ensureConversationExists called with: {
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  difyConversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "nah",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "conversation_id": "ea6c918e-a626-4966-97e5-81a88971fc06",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🔍 Looking up conversation in database: ea6c918e-a626-4966-97e5-81a88971fc06
✅ Found existing DIFY conversation: ea6c918e-a626-4966-97e5-81a88971fc06
🔄 Continuing existing conversation: ea6c918e-a626-4966-97e5-81a88971fc06
📤 [DIFY API] Sending request to chat-messages: {
  query: 'nah...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  timestamp: '2025-08-30T15:06:31.907Z'
}
📊 Context check: 31 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '9775314f2ec10119-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sat, 30 Aug 2025 15:06:32 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=KgCQrWGk8JOr9FXktaL8sDYisxNig8hsb15btpr2t9szDoL5gpOSD1uV7cOYp%2BxSd8q5%2F9c0zb16EQ7MRqC6QC7yfxUzYGk7YHxnAyoFHsPeuHPE8EeJnaIayyaAoHmXH2nHws8ROqTb"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=5765&min_rtt=4149&rtt_var=2710&sent=3&recv=5&lost=0&retrans=0&sent_bytes=234&recv_bytes=1207&delivery_rate=324897&cwnd=250&unsent_bytes=0&cid=e097ca5f57f77fd8&ts=638&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 987
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 987 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.002136 = 22 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 22 points. Balance: 5570 → 5548
🔥 [STREAM] Sending balance update to frontend: 5548
🔍 ensureConversationExists called with: {
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  difyConversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "nah",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "conversation_id": "ea6c918e-a626-4966-97e5-81a88971fc06",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🔍 Looking up conversation in database: ea6c918e-a626-4966-97e5-81a88971fc06
✅ Found existing DIFY conversation: ea6c918e-a626-4966-97e5-81a88971fc06
🔄 Continuing existing conversation: ea6c918e-a626-4966-97e5-81a88971fc06
📤 [DIFY API] Sending request to chat-messages: {
  query: 'nah...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  timestamp: '2025-08-30T15:06:43.704Z'
}
📊 Context check: 46 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '977531990e4ed5e2-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sat, 30 Aug 2025 15:06:44 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=QOyOmEpKsvgAEjq%2BgS%2FGo87le9LT6ht3xavFXZLZexy1rV75dEpuYD5WjdGKEavviOA56uvpgxF7iIFgS%2FeUxKPN5JKnQfgRVLHQzH0q7y3jRc6qbL8hXAYIWNPklRFyrT3K%2BHcJGmjM"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=4144&min_rtt=3991&rtt_var=1803&sent=4&recv=5&lost=0&retrans=0&sent_bytes=234&recv_bytes=1207&delivery_rate=258386&cwnd=245&unsent_bytes=0&cid=89bc6dda855b7e26&ts=635&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 1017
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 1017 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.002196 = 22 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 22 points. Balance: 5521 → 5499
🔥 [STREAM] Sending balance update to frontend: 5499
🔍 ensureConversationExists called with: {
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  difyConversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "nah",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "conversation_id": "ea6c918e-a626-4966-97e5-81a88971fc06",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🔍 Looking up conversation in database: ea6c918e-a626-4966-97e5-81a88971fc06
✅ Found existing DIFY conversation: ea6c918e-a626-4966-97e5-81a88971fc06
🔄 Continuing existing conversation: ea6c918e-a626-4966-97e5-81a88971fc06
📤 [DIFY API] Sending request to chat-messages: {
  query: 'nah...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  timestamp: '2025-08-30T15:07:01.840Z'
}
📊 Context check: 61 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '9775320a581dc17f-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sat, 30 Aug 2025 15:07:02 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=0SQaMa5CI1%2Byjf6MHg86j9ZQhHdsA%2FQ4MDN5dIM4AuPe4bjHBF77FIeRjLeRjjLv2PMmtqL9eA0s%2FZGa3eZkmykEZcEM2ziebrvVZ8NhDq6W1h2WuPzbPbCmEqV%2FuWFjt1MOrhljiCog"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=3888&min_rtt=3244&rtt_var=1676&sent=3&recv=5&lost=0&retrans=0&sent_bytes=234&recv_bytes=1207&delivery_rate=415536&cwnd=244&unsent_bytes=0&cid=0de37451b33c6fd1&ts=675&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 1047
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 1047 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.002256 = 23 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 23 points. Balance: 5499 → 5476
🔥 [STREAM] Sending balance update to frontend: 5476
🔍 ensureConversationExists called with: {
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  difyConversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "你好",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "conversation_id": "ea6c918e-a626-4966-97e5-81a88971fc06",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🔍 Looking up conversation in database: ea6c918e-a626-4966-97e5-81a88971fc06
✅ Found existing DIFY conversation: ea6c918e-a626-4966-97e5-81a88971fc06
🔄 Continuing existing conversation: ea6c918e-a626-4966-97e5-81a88971fc06
📤 [DIFY API] Sending request to chat-messages: {
  query: '你好...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  timestamp: '2025-08-30T15:07:38.336Z'
}
📊 Context check: 78 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '977532ee985e5c0a-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sat, 30 Aug 2025 15:07:39 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=MoS27xDzRtC0zgnKM3qfj7RYDncmiT4COwY6gxM3z9GClcUZvGcGraD2%2BNZ9Q%2F36kQbWoaL899fz7R%2Ff%2B8HrB5tt84QRyAJ%2BKG37lzeLmP1T84osDnAozWMtIquhqi4D3dP69xsqMVqW"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=6905&min_rtt=6355&rtt_var=2776&sent=3&recv=5&lost=0&retrans=0&sent_bytes=234&recv_bytes=1210&delivery_rate=212116&cwnd=250&unsent_bytes=0&cid=ae460e60d37c06b0&ts=1009&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 1077
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 1077 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.002316 = 24 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 24 points. Balance: 5476 → 5452
🔥 [STREAM] Sending balance update to frontend: 5452
🔍 ensureConversationExists called with: {
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  difyConversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=false, query=false, final=false
🔍 Full request body: {
  "message": "最终测试管理员积分扣除",
  "user": "admin-user-final",
  "stream": false
}
🆕 Generated new conversation UUID: 2c681aaf-cb8d-41ee-bf92-478dc6ea10db
🔍 Looking up conversation in database: 2c681aaf-cb8d-41ee-bf92-478dc6ea10db
📝 No existing conversation found for: 2c681aaf-cb8d-41ee-bf92-478dc6ea10db
🔧 Created new user ID mapping: admin-user-final -> e16a7fcd-3450-48ff-8076-f428627bec9b
🆕 Starting new conversation - letting DIFY initialize conversation variables
📤 [DIFY API] Sending request to chat-messages: {
  query: '最终测试管理员积分扣除...',
  inputs: {},
  response_mode: 'blocking',
  user: 'e16a7fcd-3450-48ff-8076-f428627bec9b',
  conversation_id: 'NEW_CONVERSATION',
  timestamp: '2025-08-30T23:00:19.281Z'
}
📊 New conversation, no context management needed
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '9777e7583c03e7c4-SYD',
  connection: 'keep-alive',
  'content-encoding': 'br',
  'content-type': 'application/json',
  date: 'Sat, 30 Aug 2025 23:00:23 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=x65I4EONXo%2Bn%2B3ZLCVt1kzuUT8xfUcArTPU4bwiULIfq3OaVNBwq64kmA6a2qNSKazjwBFUJqqmS1CrzBXDvqWHywTPRdbezR46qYIJWVRDjLzKdLsq95dv%2BpdA06VGI1t77vvHtJeY%2F"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=22483&min_rtt=5130&rtt_var=12711&sent=3&recv=5&lost=0&retrans=0&sent_bytes=234&recv_bytes=1179&delivery_rate=262768&cwnd=250&unsent_bytes=0&cid=8b28d17b909815b3&ts=3970&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
📥 [DIFY API] Received blocking response: {
  conversation_id: '15fa7789-0be3-4172-aec3-2d20c0bdba5b',
  message_id: '7abafc9a-1e36-48fb-9b1e-6f340805a2d1',
  answer_preview: 'COMPLETENESS: 1\n请介绍您的产品主要特色（优势和亮点）。...',
  mode: 'advanced-chat',
  hasMetadata: true,
  hasUsage: true,
  timestamp: '2025-08-30T23:00:23.824Z'
}
✅ Successfully received response from Dify API
🔄 Using existing user ID mapping for: admin-user-final
🔍 ensureConversationExists called with: {
  conversationId: '15fa7789-0be3-4172-aec3-2d20c0bdba5b',
  difyConversationId: '15fa7789-0be3-4172-aec3-2d20c0bdba5b',
  userId: 'e16a7fcd-3450-48ff-8076-f428627bec9b',
  hasSupabase: true
}
⚠️ User not found in database, creating conversation without user_id: e16a7fcd-3450-48ff-8076-f428627bec9b
✅ Created new conversation record
✅ Messages saved successfully
📤 [SERVER → FRONTEND] Sending response to frontend: {
  hasAnswer: true,
  answerLength: 35,
  conversation_id: '15fa7789-0be3-4172-aec3-2d20c0bdba5b',
  message_id: '7abafc9a-1e36-48fb-9b1e-6f340805a2d1',
  hasMetadata: true,
  hasUsage: true,
  usageDetails: {
    prompt_tokens: 903,
    completion_tokens: 26,
    total_tokens: 929,
    total_price: '0.002014',
    currency: 'USD'
  },
  metadataKeys: [ 'annotation_reply', 'retriever_resources', 'usage', 'timestamp' ],
  timestamp: '2025-08-30T23:00:25.303Z'
}
🔍 [DEBUG] responseData structure for billing: {
  hasResponseData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 929
}
💰 [BILLING-DIFY_GENERIC] Multi-node LLM: 929 tokens
💰 [COST-DIFY_GENERIC] Actual cost: $0.002014 = 21 points
🔄 Using existing user ID mapping for: admin-user-final
⚠️  [BILLING-DIFY_GENERIC] User not found in database: e16a7fcd-3450-48ff-8076-f428627bec9b
💡 [BILLING-DIFY_GENERIC] Creating guest user session for: e16a7fcd-3450-48ff-8076-f428627bec9b
⚠️  [BILLING-DIFY_GENERIC] Guest user - no points deducted, usage recorded only
📝 [BILLING-DIFY_GENERIC] Guest balance updated: 10000 → 9979 (memory only)
🔥 [BLOCKING] Adding balance update to response: 9979
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "你好",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "conversation_id": "ea6c918e-a626-4966-97e5-81a88971fc06",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🔍 Looking up conversation in database: ea6c918e-a626-4966-97e5-81a88971fc06
✅ Found existing DIFY conversation: ea6c918e-a626-4966-97e5-81a88971fc06
🔄 Continuing existing conversation: ea6c918e-a626-4966-97e5-81a88971fc06
📤 [DIFY API] Sending request to chat-messages: {
  query: '你好...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  timestamp: '2025-08-30T23:02:27.009Z'
}
📊 Context check: 95 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '9777ea7ace0ce7ce-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sat, 30 Aug 2025 23:02:29 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=DAGEvhzEJO%2FhDHjmCdIEEM7GqoAjWECjyutXA%2B4gONYqfj6DljdBVjoaJr4X%2Biiaz7%2FHBp0R8kLF9OCAXaL3HUQ9Do75EC9eCZboPeOF2fxfLabiAO7c7dbU87zsJlIRuitcewn64I5T"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=4166&min_rtt=3957&rtt_var=1902&sent=5&recv=5&lost=0&retrans=0&sent_bytes=2828&recv_bytes=939&delivery_rate=718167&cwnd=252&unsent_bytes=0&cid=a97c19406c5e5d48&ts=1505&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 1107
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 1107 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.002376 = 24 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 24 points. Balance: 5452 → 5428
🔥 [STREAM] Sending balance update to frontend: 5428
🔍 ensureConversationExists called with: {
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  difyConversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=false, query=false, final=false
🔍 Full request body: {
  "message": "完整功能测试",
  "user": "final-test-user",
  "stream": false
}
🆕 Generated new conversation UUID: 437da868-7381-4b75-8be8-3ae70572d03a
🔍 Looking up conversation in database: 437da868-7381-4b75-8be8-3ae70572d03a
📝 No existing conversation found for: 437da868-7381-4b75-8be8-3ae70572d03a
🔄 Using existing user ID mapping for: final-test-user
🆕 Starting new conversation - letting DIFY initialize conversation variables
📤 [DIFY API] Sending request to chat-messages: {
  query: '完整功能测试...',
  inputs: {},
  response_mode: 'blocking',
  user: '9e745e92-a4e5-4abc-8642-937d12d2a9b9',
  conversation_id: 'NEW_CONVERSATION',
  timestamp: '2025-08-30T23:16:38.328Z'
}
📊 New conversation, no context management needed
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '9777ff3dea1de7e8-SYD',
  connection: 'keep-alive',
  'content-encoding': 'br',
  'content-type': 'application/json',
  date: 'Sat, 30 Aug 2025 23:16:41 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=70nOOi9Vf95BjAXVcTuRKcG8Olf32qZrbQFc63wE09GIzbfs2bZvLRKl2tCuS3Per3BX5x3CWMJHpV5EGX3YPwRLMZuAOdd8z%2BQhtW0EwjhPwowoaDzMrQviRoZhAO9cInfMKoYR%2Fbhs"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=4003&min_rtt=3456&rtt_var=1687&sent=3&recv=5&lost=0&retrans=0&sent_bytes=234&recv_bytes=1164&delivery_rate=390046&cwnd=248&unsent_bytes=0&cid=ad718c3203f09872&ts=2989&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
📥 [DIFY API] Received blocking response: {
  conversation_id: '9d93a833-bb5b-4714-87fe-0adfb5352732',
  message_id: '537a1a28-1218-475e-97b5-a6fba98fb95b',
  answer_preview: 'COMPLETENESS: 0  \n您好，为了更好地为您生成营销文案，请先介绍您的产品详情（是什么产品，如何解决用户的问题）。...',
  mode: 'advanced-chat',
  hasMetadata: true,
  hasUsage: true,
  timestamp: '2025-08-30T23:16:41.907Z'
}
✅ Successfully received response from Dify API
🔄 Using existing user ID mapping for: final-test-user
🔍 ensureConversationExists called with: {
  conversationId: '9d93a833-bb5b-4714-87fe-0adfb5352732',
  difyConversationId: '9d93a833-bb5b-4714-87fe-0adfb5352732',
  userId: '9e745e92-a4e5-4abc-8642-937d12d2a9b9',
  hasSupabase: true
}
⚠️ User not found in database, creating conversation without user_id: 9e745e92-a4e5-4abc-8642-937d12d2a9b9
✅ Created new conversation record
✅ Messages saved successfully
📤 [SERVER → FRONTEND] Sending response to frontend: {
  hasAnswer: true,
  answerLength: 63,
  conversation_id: '9d93a833-bb5b-4714-87fe-0adfb5352732',
  message_id: '537a1a28-1218-475e-97b5-a6fba98fb95b',
  hasMetadata: true,
  hasUsage: true,
  usageDetails: {
    prompt_tokens: 930,
    completion_tokens: 41,
    total_tokens: 971,
    total_price: '0.002188',
    currency: 'USD'
  },
  metadataKeys: [ 'annotation_reply', 'retriever_resources', 'usage', 'timestamp' ],
  timestamp: '2025-08-30T23:16:42.648Z'
}
🔍 [DEBUG] responseData structure for billing: {
  hasResponseData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 971
}
💰 [BILLING-DIFY_GENERIC] Multi-node LLM: 971 tokens
💰 [COST-DIFY_GENERIC] Actual cost: $0.002188 = 22 points
🔄 Using existing user ID mapping for: final-test-user
⚠️  [BILLING-DIFY_GENERIC] User not found in database: 9e745e92-a4e5-4abc-8642-937d12d2a9b9
💡 [BILLING-DIFY_GENERIC] Creating guest user session for: 9e745e92-a4e5-4abc-8642-937d12d2a9b9
⚠️  [BILLING-DIFY_GENERIC] Guest user - no points deducted, usage recorded only
📝 [BILLING-DIFY_GENERIC] Guest balance updated: 9929 → 9907 (memory only)
🔥 [BLOCKING] Adding balance update to response: 9907
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "你好",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "conversation_id": "ea6c918e-a626-4966-97e5-81a88971fc06",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🔍 Looking up conversation in database: ea6c918e-a626-4966-97e5-81a88971fc06
✅ Found existing DIFY conversation: ea6c918e-a626-4966-97e5-81a88971fc06
🔄 Continuing existing conversation: ea6c918e-a626-4966-97e5-81a88971fc06
📤 [DIFY API] Sending request to chat-messages: {
  query: '你好...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  timestamp: '2025-08-30T23:18:17.816Z'
}
📊 Context check: 112 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '977801ac4f681f27-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sat, 30 Aug 2025 23:18:19 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=1Wck%2BewI5PBF71lVpyMoEPs9RgJGb1giyIgu0hBIcwgXMWXZ%2BxugZWBPp5wMvPzYPy5N0zkmL%2FPtuhpsap3wjFzFQfEnLtsjkUJtwULKUaeLZdAY7VEayYUqlyDFS5GRBrOgL39wS%2FMn"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=4250&min_rtt=3969&rtt_var=2051&sent=3&recv=5&lost=0&retrans=0&sent_bytes=234&recv_bytes=1210&delivery_rate=216685&cwnd=250&unsent_bytes=0&cid=fcd8feda5a370b9c&ts=1014&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 1137
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 1137 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.002436 = 25 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 25 points. Balance: 5428 → 5403
🔥 [STREAM] Sending balance update to frontend: 5403
🔍 ensureConversationExists called with: {
  conversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  difyConversationId: 'ea6c918e-a626-4966-97e5-81a88971fc06',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "你好",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🆕 Generated new conversation UUID: 3a03421c-6b53-4107-8223-40d7f346776a
🔍 Looking up conversation in database: 3a03421c-6b53-4107-8223-40d7f346776a
📝 No existing conversation found for: 3a03421c-6b53-4107-8223-40d7f346776a
🆕 Starting new conversation - letting DIFY initialize conversation variables
📤 [DIFY API] Sending request to chat-messages: {
  query: '你好...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: 'NEW_CONVERSATION',
  timestamp: '2025-08-30T23:20:56.153Z'
}
📊 New conversation, no context management needed
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '97780588cbc3eff4-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sat, 30 Aug 2025 23:20:59 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=qQGoIDEVx7Vc3HuS2gEwIgDhjxfMgmkvm%2Fik1u9xIjLe76LpIKeb3wyMlgdbJSQLMM2cw6bnV7kkfQMQIEt%2FPhsQeTuJ4jNYaHoPc3f%2FgOp1Ui8m0A%2BL%2FCECrKJtw629MG2kNYd7qVBp"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=3993&min_rtt=3985&rtt_var=1511&sent=3&recv=5&lost=0&retrans=0&sent_bytes=234&recv_bytes=1153&delivery_rate=332757&cwnd=250&unsent_bytes=0&cid=22128ec9297fbe05&ts=2669&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 942
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 942 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.002076 = 21 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 21 points. Balance: 5403 → 5382
🔥 [STREAM] Sending balance update to frontend: 5382
🔍 ensureConversationExists called with: {
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  difyConversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Verified user exists in database: 9dee4891-89a6-44ee-8fe8-69097846e97d
✅ Created new conversation record
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "你好",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "conversation_id": "ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🔍 Looking up conversation in database: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
✅ Found existing DIFY conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
🔄 Continuing existing conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
📤 [DIFY API] Sending request to chat-messages: {
  query: '你好...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  timestamp: '2025-08-30T23:21:15.634Z'
}
📊 Context check: 20 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '977806051bdbe7e5-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sat, 30 Aug 2025 23:21:16 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=Z%2BlvdPhw2bDz6F%2BJ8D7DfSk7uIvuFcLtcHZKj1fNcWKlV9S8p9WRH3%2FJn%2BvmaoCtK8iSAub0IKr8OnemOB11gfqldXmS2jDqbOx6Sq1SCrulxoMDeRIFCD4rW31V%2FFM4xJ0bPHmtQn%2Bi"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=4889&min_rtt=4064&rtt_var=2113&sent=3&recv=5&lost=0&retrans=0&sent_bytes=234&recv_bytes=1210&delivery_rate=331692&cwnd=250&unsent_bytes=0&cid=128a2844cd02cc31&ts=665&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 977
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 977 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.002146 = 22 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 22 points. Balance: 5356 → 5334
🔥 [STREAM] Sending balance update to frontend: 5334
🔍 ensureConversationExists called with: {
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  difyConversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "你好",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "conversation_id": "ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🔍 Looking up conversation in database: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
✅ Found existing DIFY conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
🔄 Continuing existing conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
📤 [DIFY API] Sending request to chat-messages: {
  query: '你好...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  timestamp: '2025-08-30T23:21:48.385Z'
}
📊 Context check: 37 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '977806cf3fad5723-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sat, 30 Aug 2025 23:21:49 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=TZ9RyGN9A8KNfoHTt%2BpThWgDvWsKWyvjr21MJzX3Dv0ToLICA6XUOFLoE3aYK74cQizrb%2FRetflb1K3VLDrQQDptvsC6El1D6vgJsywxjmV9ZCMn%2FGiv5Slmkjy%2BGNc8a2j%2FcHP2pzp%2B"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=4016&min_rtt=3978&rtt_var=1569&sent=3&recv=5&lost=0&retrans=0&sent_bytes=234&recv_bytes=1210&delivery_rate=314365&cwnd=250&unsent_bytes=0&cid=2bec6573e0c26f97&ts=634&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 1012
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 1012 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.002216 = 23 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 23 points. Balance: 5334 → 5311
🔥 [STREAM] Sending balance update to frontend: 5311
🔍 ensureConversationExists called with: {
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  difyConversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "你好",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "conversation_id": "ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🔍 Looking up conversation in database: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
✅ Found existing DIFY conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
🔄 Continuing existing conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
📤 [DIFY API] Sending request to chat-messages: {
  query: '你好...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  timestamp: '2025-08-30T23:22:04.027Z'
}
📊 Context check: 54 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '977807310ce9d5e3-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sat, 30 Aug 2025 23:22:05 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=8QPw7YpllM%2BCUAcbGdaIoARnueW0%2BVk2Kwq5e6fYxRsWeKkTZhVSlV9lD29DqaMCnIuALGDqVG9qKQI1wkNfU1TxzdACBWRDecze8ma3%2BnvxqVaB3DcYEN7VSb1QpMto6EB9zQUuJ98V"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=8282&min_rtt=3365&rtt_var=4527&sent=3&recv=5&lost=0&retrans=0&sent_bytes=234&recv_bytes=1210&delivery_rate=400594&cwnd=250&unsent_bytes=0&cid=3be93e1a9d42097a&ts=929&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 1047
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 1047 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.002286 = 23 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 23 points. Balance: 5311 → 5288
🔥 [STREAM] Sending balance update to frontend: 5288
🔍 ensureConversationExists called with: {
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  difyConversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "你好",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "conversation_id": "ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🔍 Looking up conversation in database: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
✅ Found existing DIFY conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
🔄 Continuing existing conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
📤 [DIFY API] Sending request to chat-messages: {
  query: '你好...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  timestamp: '2025-08-30T23:37:22.986Z'
}
📊 Context check: 71 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '97781da0bda8a6d9-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sat, 30 Aug 2025 23:37:24 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=7xQY2Ka8APWmvQ0UqpYuVaYwY0qU5%2FGDIIm7afv5A7S5nTBsPMwLR%2Bc3Gav1K2wf1B6bm5kLc6GHM0329zGZr3Ri4zczX1yWXazv4w6nc5lNAYD7e9OttXfdM2kEhaPN8TtFDjQgsSpq"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=4011&min_rtt=3985&rtt_var=1546&sent=3&recv=5&lost=0&retrans=0&sent_bytes=234&recv_bytes=1210&delivery_rate=321411&cwnd=250&unsent_bytes=0&cid=71c40437ad7af66e&ts=972&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 1082
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 1082 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.002356 = 24 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 24 points. Balance: 5259 → 5235
🔥 [STREAM] Sending balance update to frontend: 5235
🔍 ensureConversationExists called with: {
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  difyConversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "你",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "conversation_id": "ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🔍 Looking up conversation in database: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
✅ Found existing DIFY conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
🔄 Continuing existing conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
📤 [DIFY API] Sending request to chat-messages: {
  query: '你...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  timestamp: '2025-08-30T23:37:36.521Z'
}
📊 Context check: 87 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '97781df95d31dac6-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sat, 30 Aug 2025 23:37:38 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=8mOsz%2FJr3G%2BsAtz2TpoivNpNWQezVN96RimHHCLc044kRBeE6YNeLJhk4dlRB1XEVTS82lTWlXweBscf5b6S65tAxwapfnjoqYn5YqYnKtJK%2FraqmBqPU6wA3z5s5IeU70UqDUtB7JMo"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=5614&min_rtt=4995&rtt_var=3113&sent=3&recv=5&lost=0&retrans=0&sent_bytes=234&recv_bytes=1207&delivery_rate=135422&cwnd=250&unsent_bytes=0&cid=c4958c933e7c75a1&ts=619&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 1117
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 1117 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.002426 = 25 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 25 points. Balance: 5235 → 5210
🔥 [STREAM] Sending balance update to frontend: 5210
🔍 ensureConversationExists called with: {
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  difyConversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "你",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "conversation_id": "ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🔍 Looking up conversation in database: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
✅ Found existing DIFY conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
🔄 Continuing existing conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
📤 [DIFY API] Sending request to chat-messages: {
  query: '你...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  timestamp: '2025-08-30T23:37:45.275Z'
}
📊 Context check: 103 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '97781e2bddafa953-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sat, 30 Aug 2025 23:37:46 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=4GaM6%2FtyVXtkC5e%2F%2BZ3EQ6DnWH3eTsHzF8D0ZCKstk46T%2FwYSE79E5BiMYasU%2F64C%2BfZH365G2%2FBsTrA2%2FR%2Ff7Q%2BLwT%2F7KdRTU5ugQZjlyaG%2Fcw5aZ1%2FBxvlriwDKKHoa%2FbzfAJmDWwM"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=7397&min_rtt=3486&rtt_var=3993&sent=3&recv=5&lost=0&retrans=0&sent_bytes=234&recv_bytes=1207&delivery_rate=386689&cwnd=250&unsent_bytes=0&cid=30d262ebe88f2bf2&ts=649&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 1152
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 1152 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.002496 = 25 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 25 points. Balance: 5180 → 5155
🔥 [STREAM] Sending balance update to frontend: 5155
🔍 ensureConversationExists called with: {
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  difyConversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "你",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "conversation_id": "ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🔍 Looking up conversation in database: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
✅ Found existing DIFY conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
🔄 Continuing existing conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
📤 [DIFY API] Sending request to chat-messages: {
  query: '你...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  timestamp: '2025-08-30T23:39:51.787Z'
}
📊 Context check: 119 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '97782142be2c7238-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sat, 30 Aug 2025 23:39:53 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=a2uK68G3RPoyiZYtEVvXceBSQ4JEuriij%2B%2BisiCyphUGqgvJUICiH6XyO10CsyqevMXRdwa%2Fi%2BH6e7fcQmkhPcSTJwk9ZOq3ChE7SgABw7BZa2HgpedzJtG7SOoZH1HKhKd%2BMvXnsmlF"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=6523&min_rtt=3813&rtt_var=3366&sent=3&recv=5&lost=0&retrans=0&sent_bytes=234&recv_bytes=1207&delivery_rate=353527&cwnd=250&unsent_bytes=0&cid=15f199ce58cab500&ts=946&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 1187
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 1187 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.002566 = 26 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 26 points. Balance: 5155 → 5129
🔥 [STREAM] Sending balance update to frontend: 5129
🔍 ensureConversationExists called with: {
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  difyConversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "你好",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "conversation_id": "ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🔍 Looking up conversation in database: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
✅ Found existing DIFY conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
🔄 Continuing existing conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
📤 [DIFY API] Sending request to chat-messages: {
  query: '你好...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  timestamp: '2025-08-30T23:40:00.120Z'
}
📊 Context check: 136 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '97782176fd31e7cc-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sat, 30 Aug 2025 23:40:01 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=oyXoVIJIu2vB8%2FP8AporGXuCngb7XYbrVhcNOH4iJx%2F3xs1%2BzS40XGvTtyFdd8gks7oQ2i1R3gK%2BXguloYDcTnmvbEPzLcGe4LxfZnZbcQMLXvT7hzVOse12A%2FjbdpB%2Bx1TKJXIfC689"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=3972&min_rtt=3894&rtt_var=1516&sent=3&recv=5&lost=0&retrans=0&sent_bytes=234&recv_bytes=1210&delivery_rate=346173&cwnd=250&unsent_bytes=0&cid=97941ada91728bf9&ts=614&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 1222
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 1222 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.002636 = 27 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 27 points. Balance: 5097 → 5070
🔥 [STREAM] Sending balance update to frontend: 5070
🔍 ensureConversationExists called with: {
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  difyConversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "你好",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "conversation_id": "ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🔍 Looking up conversation in database: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
✅ Found existing DIFY conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
🔄 Continuing existing conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
📤 [DIFY API] Sending request to chat-messages: {
  query: '你好...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  timestamp: '2025-08-30T23:40:10.515Z'
}
📊 Context check: 153 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '977821b7ed988034-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sat, 30 Aug 2025 23:40:11 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=UWB0qfXnkBt7R5hgWYRIRLJPUOl52qy2%2B63uNJe3PEiJ5yOuFlJ45oRQis2MHgvkmgHahmTDqQSWbKOX59MHM52NMOD6kAFjtR3O7IE%2FrEaKg%2Figybpy1GAcgtExUmbIL9pnNe26PvPW"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=3873&min_rtt=3200&rtt_var=1681&sent=5&recv=5&lost=0&retrans=0&sent_bytes=2828&recv_bytes=939&delivery_rate=1263750&cwnd=252&unsent_bytes=0&cid=63cfd5b143129871&ts=631&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 1257
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 1257 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.002706 = 28 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 28 points. Balance: 5070 → 5042
🔥 [STREAM] Sending balance update to frontend: 5042
🔍 ensureConversationExists called with: {
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  difyConversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "你好",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "conversation_id": "ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🔍 Looking up conversation in database: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
✅ Found existing DIFY conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
🔄 Continuing existing conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
📤 [DIFY API] Sending request to chat-messages: {
  query: '你好...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  timestamp: '2025-08-30T23:41:43.761Z'
}
📊 Context check: 170 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '977823fe89f9a826-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sat, 30 Aug 2025 23:41:45 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=opPC9iTQJvEsEdqVQi%2BI27QosqvQxIEKDmrUlWnGMQnz8g3CAGuobt%2BiP0Yr36TEjsA8a2NX02gWwmjACYClXrdMSHOzAIJKsFJjoLTZNTovRub3fCNsQlmblcV%2BcH896DL1WVWozk8%2F"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=5407&min_rtt=4969&rtt_var=2740&sent=3&recv=5&lost=0&retrans=0&sent_bytes=234&recv_bytes=1210&delivery_rate=158999&cwnd=250&unsent_bytes=0&cid=6634c0befb964a38&ts=991&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 1292
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 1292 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.002776 = 28 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 28 points. Balance: 5042 → 5014
🔥 [STREAM] Sending balance update to frontend: 5014
🔍 ensureConversationExists called with: {
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  difyConversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "你好",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "conversation_id": "ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🔍 Looking up conversation in database: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
✅ Found existing DIFY conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
🔄 Continuing existing conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
📤 [DIFY API] Sending request to chat-messages: {
  query: '你好...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  timestamp: '2025-08-30T23:58:20.715Z'
}
📊 Context check: 187 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '97783c568e3fe7f1-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sat, 30 Aug 2025 23:58:22 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=wXjcxSlmUkWXLr7awF3JYuHZEwDQOB7gyOyY5hQa5WEe9VxhZdCVDTnO7ELgDnMKfb%2BjFSptAGWU14VqIQiX31t6DoWAgb1vGCd0nrhF5xTqR39TeZJ8zvSpQsN3%2Bg7W%2F4W%2Fd5pKDrzr"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=3980&min_rtt=3967&rtt_var=1497&sent=3&recv=5&lost=0&retrans=0&sent_bytes=234&recv_bytes=1210&delivery_rate=339803&cwnd=249&unsent_bytes=0&cid=26fa5fa207466697&ts=1017&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 1327
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 1327 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.002846 = 29 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 29 points. Balance: 5014 → 4985
🔥 [STREAM] Sending balance update to frontend: 4985
🔍 ensureConversationExists called with: {
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  difyConversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "你好",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "conversation_id": "ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🔍 Looking up conversation in database: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
✅ Found existing DIFY conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
🔄 Continuing existing conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
📤 [DIFY API] Sending request to chat-messages: {
  query: '你好...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  timestamp: '2025-08-30T23:58:33.866Z'
}
📊 Context check: 204 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '97783ca76e9698ec-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sat, 30 Aug 2025 23:58:34 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=6QIHwczAbB2YDtEtuMMppPGNX2RKvvPTcnymaanvHxjw%2B1MiW%2FBktOtsgkM2N%2BQfyX0bPB2RbZycKq7usXKnL5iaSlaW44ueZACW%2BbeK6kI7rs5Fy7sE6AVX8CGagF1I%2F0LuZZ3UPcwE"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=6593&min_rtt=3746&rtt_var=3438&sent=3&recv=5&lost=0&retrans=0&sent_bytes=234&recv_bytes=1210&delivery_rate=359850&cwnd=249&unsent_bytes=0&cid=610a55cc246c7dfb&ts=604&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 1362
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 1362 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.002916 = 30 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 30 points. Balance: 4949 → 4919
🔥 [STREAM] Sending balance update to frontend: 4919
🔍 ensureConversationExists called with: {
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  difyConversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "你好",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "conversation_id": "ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🔍 Looking up conversation in database: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
✅ Found existing DIFY conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
🔄 Continuing existing conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
📤 [DIFY API] Sending request to chat-messages: {
  query: '你好...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  timestamp: '2025-08-30T23:58:56.711Z'
}
📊 Context check: 221 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '97783d387d58573f-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sat, 30 Aug 2025 23:58:57 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=Ah1N%2Fwrn7Kb%2FuMgRrgU1ThqEWR6oddGrR5pFRpDyTvyZFKue71U9ahib%2Fa55Bhb0SCW4H4Lxu2ibgHtUFnz2o7DZM9ghyK%2B4IczPXGFEBc9ReffS%2FKG3bUdO7247uUvUrOcT6e%2B02Fx2"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=4005&min_rtt=3983&rtt_var=1538&sent=3&recv=5&lost=0&retrans=0&sent_bytes=234&recv_bytes=1210&delivery_rate=324038&cwnd=250&unsent_bytes=0&cid=658fe8ace3d23bd3&ts=651&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 1397
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 1397 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.002986 = 30 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 30 points. Balance: 4919 → 4889
🔥 [STREAM] Sending balance update to frontend: 4889
🔍 ensureConversationExists called with: {
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  difyConversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "你好",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "conversation_id": "ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🔍 Looking up conversation in database: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
✅ Found existing DIFY conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
🔄 Continuing existing conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
📤 [DIFY API] Sending request to chat-messages: {
  query: '你好...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  timestamp: '2025-08-30T23:59:47.233Z'
}
📊 Context check: 238 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '97783e71f9478078-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sat, 30 Aug 2025 23:59:48 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=xPGtzP%2FP2ezEwAhTsdoXO5z2A9QEnW4B5aZb%2FMQlh6nojAg0OOQaZz6reYbJIadZlGqUIVehkaZbMeZm%2FW3hL28vzcPNc45IN%2FBQvLHhTNiMQbuuA9Mxdzb%2FYdCcMgNCRtHS1xBP%2Fk3L"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=6554&min_rtt=3607&rtt_var=3458&sent=3&recv=5&lost=0&retrans=0&sent_bytes=234&recv_bytes=1210&delivery_rate=373717&cwnd=250&unsent_bytes=0&cid=df0f1750760bc843&ts=958&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 1432
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 1432 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.003056 = 31 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 31 points. Balance: 4889 → 4858
🔥 [STREAM] Sending balance update to frontend: 4858
🔍 ensureConversationExists called with: {
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  difyConversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "你好",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "conversation_id": "ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🔍 Looking up conversation in database: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
✅ Found existing DIFY conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
🔄 Continuing existing conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
📤 [DIFY API] Sending request to chat-messages: {
  query: '你好...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  timestamp: '2025-08-30T23:59:52.750Z'
}
📊 Context check: 255 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '97783e945d918078-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sat, 30 Aug 2025 23:59:53 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=gIlcxiDr6YfTmLXN0dz%2BjtBC1jO7QwjKhKqPfsZP8tnDtkkT9e1w2GFLPiIUG4QAzNQoF40rIWcwx%2Fn2ajJXspEj2RgruNDWK5Cy9RPGdSv95d0ydKWHdEAezDpm4hzcB6wyzsXh5IVc"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=36169&min_rtt=3146&rtt_var=30160&sent=75&recv=40&lost=0&retrans=2&sent_bytes=43695&recv_bytes=1685&delivery_rate=2533834&cwnd=257&unsent_bytes=0&cid=df0f1750760bc843&ts=5934&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 1467
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 1467 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.003126 = 32 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 32 points. Balance: 4858 → 4826
🔥 [STREAM] Sending balance update to frontend: 4826
🔍 ensureConversationExists called with: {
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  difyConversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "你哈",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "conversation_id": "ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🔍 Looking up conversation in database: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
✅ Found existing DIFY conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
🔄 Continuing existing conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
📤 [DIFY API] Sending request to chat-messages: {
  query: '你哈...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  timestamp: '2025-08-31T00:00:28.943Z'
}
📊 Context check: 272 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '97783f77fb71c17f-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sun, 31 Aug 2025 00:00:30 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=caUknxEGP9YMGu7PNeHbcOw%2FII3pHV%2F85ZYSFoGbGaVOM6ks9d%2FyYekYJBWOx%2BSWA%2BcRKmtoXn2ByDjsnXVhg18O60K5wOctH1WGTrAgmhoC8KqnscUit07kn6L5eqOYrMa2YPeu7SIw"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=5161&min_rtt=4968&rtt_var=2249&sent=3&recv=5&lost=0&retrans=0&sent_bytes=234&recv_bytes=1210&delivery_rate=206938&cwnd=244&unsent_bytes=0&cid=d36739964c01aa58&ts=1419&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 1503
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 1503 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.003198 = 32 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 32 points. Balance: 4826 → 4794
🔥 [STREAM] Sending balance update to frontend: 4794
🔍 ensureConversationExists called with: {
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  difyConversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "你好",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "conversation_id": "ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🔍 Looking up conversation in database: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
✅ Found existing DIFY conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
🔄 Continuing existing conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
📤 [DIFY API] Sending request to chat-messages: {
  query: '你好...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  timestamp: '2025-08-31T00:00:43.512Z'
}
📊 Context check: 289 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '97783fd1b87aa980-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sun, 31 Aug 2025 00:00:44 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=GLtlhPp9osvovinf4YBqgTk58KyFKxul8rT5F%2FBBHbNETxaMs0pzv0zDNBBUxMD3plmf4U7KBNzdcx3G7inVHliOIn46JlYr%2Ff9R%2BsEZs9EztZZPHDakNs6YKKFuxwSLtM82wkMZJTEK"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=5218&min_rtt=4937&rtt_var=2414&sent=3&recv=5&lost=0&retrans=0&sent_bytes=234&recv_bytes=1210&delivery_rate=187560&cwnd=250&unsent_bytes=0&cid=14e59c29cee3c6b8&ts=449&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 1538
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 1538 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.003268 = 33 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 33 points. Balance: 4754 → 4721
🔥 [STREAM] Sending balance update to frontend: 4721
🔍 ensureConversationExists called with: {
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  difyConversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "你好",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "conversation_id": "ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🔍 Looking up conversation in database: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
✅ Found existing DIFY conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
🔄 Continuing existing conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
📤 [DIFY API] Sending request to chat-messages: {
  query: '你好...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  timestamp: '2025-08-31T00:13:07.354Z'
}
📊 Context check: 306 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '977851fb8ad5a965-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sun, 31 Aug 2025 00:13:08 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=BY363FAK9la%2BRIAlBGKAvG0OvVynbpU8mxYsYAR3of1BvIsnWQmUFVryWOjRJ6DChRYHzLGaZqmQm3LacosZw3m9lF%2B2xV4JNtScAygAcktgyd0cmS8OB5n0O4W2XXDX1%2BznpxK0qAz7"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=3950&min_rtt=3881&rtt_var=1504&sent=3&recv=5&lost=0&retrans=0&sent_bytes=234&recv_bytes=1210&delivery_rate=347333&cwnd=250&unsent_bytes=0&cid=562a21f1b5b8416b&ts=971&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 1573
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 1573 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.003338 = 34 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 34 points. Balance: 4721 → 4687
🔥 [STREAM] Sending balance update to frontend: 4687
🔍 ensureConversationExists called with: {
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  difyConversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "你",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "conversation_id": "ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🔍 Looking up conversation in database: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
✅ Found existing DIFY conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
🔄 Continuing existing conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
📤 [DIFY API] Sending request to chat-messages: {
  query: '你...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  timestamp: '2025-08-31T00:16:32.412Z'
}
📊 Context check: 322 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '977856fc982aa97a-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sun, 31 Aug 2025 00:16:33 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=H9OkKEuMXfqlO%2BcPFDodFjsJiP2Y4G%2BzJQ1tSNBaDCwg00i0%2BqV1Lny%2BL%2FS8MYVRaKH8138pdZIcsIuclcj7yJA3PqQCNW2OowxbCd%2FL2xaLlc6a%2B5AV31Jkb8arGiNfOyCFTKIPKWPY"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=4520&min_rtt=3969&rtt_var=2592&sent=3&recv=5&lost=0&retrans=0&sent_bytes=234&recv_bytes=1207&delivery_rate=160782&cwnd=250&unsent_bytes=0&cid=ac72001962a35f5e&ts=952&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 1608
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 1608 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.003408 = 35 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 35 points. Balance: 4645 → 4610
🔥 [STREAM] Sending balance update to frontend: 4610
🔍 ensureConversationExists called with: {
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  difyConversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "你好",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "conversation_id": "ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🔍 Looking up conversation in database: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
✅ Found existing DIFY conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
🔄 Continuing existing conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
📤 [DIFY API] Sending request to chat-messages: {
  query: '你好...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  timestamp: '2025-08-31T00:17:02.651Z'
}
📊 Context check: 339 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '977857b9a8a1e7ec-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sun, 31 Aug 2025 00:17:03 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=1qr%2FIpT0TFMt4yHACVNGAu85cJ4TmQiYMADf0N1NlWOrdwQ%2Bf7jKUmg60OlEAZsXYSE%2FZzAb4tpiAPEYWOh1Wir%2BolpYs0egApL%2BjOxjNv7QVaXCETf5iSu0HCGLO80QP4sI7JqDDDt4"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=3979&min_rtt=3963&rtt_var=1519&sent=3&recv=5&lost=0&retrans=0&sent_bytes=234&recv_bytes=1210&delivery_rate=329262&cwnd=250&unsent_bytes=0&cid=d23b76fad3cda468&ts=635&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 1643
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 1643 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.003478 = 35 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 35 points. Balance: 4567 → 4532
🔥 [STREAM] Sending balance update to frontend: 4532
🔍 ensureConversationExists called with: {
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  difyConversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "你好",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "conversation_id": "ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🔍 Looking up conversation in database: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
✅ Found existing DIFY conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
🔄 Continuing existing conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
📤 [DIFY API] Sending request to chat-messages: {
  query: '你好...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  timestamp: '2025-08-31T00:19:21.141Z'
}
📊 Context check: 356 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '97785b1b7ceea7f9-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sun, 31 Aug 2025 00:19:22 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=dlI0%2FxhIhgIkaS4aathQaTgNwsajpFa0MFVaPFxX0ZtYk0fC%2BG%2F53cnT%2Bp%2FfRVyZQtnMFrkmwwYBTbQ%2BpPY%2B%2FMo1qg%2FIkQ9IqPvl05zMIq1BxDKP5pin309XLy0JMk8Vo2WEdVdoqQXp"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=4863&min_rtt=4283&rtt_var=2020&sent=3&recv=5&lost=0&retrans=0&sent_bytes=234&recv_bytes=1210&delivery_rate=314732&cwnd=250&unsent_bytes=0&cid=8d209bca6df4c608&ts=958&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 1678
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 1678 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.003548 = 36 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 36 points. Balance: 4532 → 4496
🔥 [STREAM] Sending balance update to frontend: 4496
🔍 ensureConversationExists called with: {
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  difyConversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "你好",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "conversation_id": "ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🔍 Looking up conversation in database: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
✅ Found existing DIFY conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
🔄 Continuing existing conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
📤 [DIFY API] Sending request to chat-messages: {
  query: '你好...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  timestamp: '2025-08-31T00:51:46.431Z'
}
📊 Context check: 373 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '97788a9f3bb4358b-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sun, 31 Aug 2025 00:51:48 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=Hm%2FwyLEBl1bfmwLCoiIMINYBbgHLOrDPWDsdo1v%2BKckc0nLM9ZwSt%2BqMrtFAmhRC4z32a0UFG%2BC%2BUWrkDt6g7PQWrdoaLiGUHbadyvBIQltrtIAE22N2QX02zCKKwcBBP8jdTPPj8S22"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=4432&min_rtt=3972&rtt_var=2409&sent=5&recv=5&lost=0&retrans=0&sent_bytes=2826&recv_bytes=939&delivery_rate=528420&cwnd=252&unsent_bytes=0&cid=126180b9b5c8e1a5&ts=1136&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 1713
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 1713 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.003618 = 37 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 37 points. Balance: 4452 → 4415
🔥 [STREAM] Sending balance update to frontend: 4415
🔍 ensureConversationExists called with: {
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  difyConversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "你好",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "conversation_id": "ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🔍 Looking up conversation in database: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
✅ Found existing DIFY conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
🔄 Continuing existing conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
📤 [DIFY API] Sending request to chat-messages: {
  query: '你好...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  timestamp: '2025-08-31T00:52:07.017Z'
}
📊 Context check: 390 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '97788b19cdf8a95c-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sun, 31 Aug 2025 00:52:07 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=agdisCQlUHAjV0s%2FNQIss0ZWt8uK7wd0sRCo0VKM5oXUd05TtiqGVZ5IHByKfj7R71YuXZZC%2FWy96Zgqfhg879s58MYsVozHb5vOQAU8dOJkbRMdiia39flXdQfp6XQWYv%2FlZtBS4XkV"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=3984&min_rtt=3930&rtt_var=1512&sent=3&recv=5&lost=0&retrans=0&sent_bytes=234&recv_bytes=1210&delivery_rate=343002&cwnd=250&unsent_bytes=0&cid=3830a44519908ecd&ts=668&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 1748
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 1748 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.003688 = 37 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 37 points. Balance: 4415 → 4378
🔥 [STREAM] Sending balance update to frontend: 4378
🔍 ensureConversationExists called with: {
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  difyConversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "你好",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "conversation_id": "ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🔍 Looking up conversation in database: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
✅ Found existing DIFY conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
🔄 Continuing existing conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
📤 [DIFY API] Sending request to chat-messages: {
  query: '你好...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  timestamp: '2025-08-31T00:52:16.945Z'
}
📊 Context check: 407 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '97788b57cb79e7ce-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sun, 31 Aug 2025 00:52:17 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=%2Fj2V7b%2BEa7k1n0jEP4Oduv5UAoB0jrx23CdefYIwqCv7juVOoGuG5AxqjOvCRySTfYmj9D%2Ffen5C7zQFARoxe15glWygkhxnvso2hAb1IJQ6qMNiyPCj9r3Mf8TF26O5S%2BeUCvT34qEl"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=3911&min_rtt=3445&rtt_var=1625&sent=3&recv=5&lost=0&retrans=0&sent_bytes=234&recv_bytes=1210&delivery_rate=391291&cwnd=250&unsent_bytes=0&cid=b403cf6153005a99&ts=740&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 1783
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 1783 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.003758 = 38 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 38 points. Balance: 4332 → 4294
🔥 [STREAM] Sending balance update to frontend: 4294
🔍 ensureConversationExists called with: {
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  difyConversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "你好",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "conversation_id": "ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🔍 Looking up conversation in database: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
✅ Found existing DIFY conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
🔄 Continuing existing conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
📤 [DIFY API] Sending request to chat-messages: {
  query: '你好...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  timestamp: '2025-08-31T00:52:29.859Z'
}
📊 Context check: 424 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '97788ba88f5ba6d9-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sun, 31 Aug 2025 00:52:30 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=O9CZywnQu0UHE4OigIvt2plMrtuL9zteZNo%2FHsejPaB2PQZ7YZzyqZw2Xj4rJXZasRVBBex0c3LRgk%2BqG%2F9ky398Km5PZoN14b9Dgg4v5AJ9wM5EIxFCAy9iCvIX8oseYdmspIgqDtkg"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=5521&min_rtt=3964&rtt_var=4601&sent=3&recv=5&lost=0&retrans=0&sent_bytes=234&recv_bytes=1210&delivery_rate=82080&cwnd=250&unsent_bytes=0&cid=52121889939380ea&ts=689&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 1818
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 1818 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.003828 = 39 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 39 points. Balance: 4294 → 4255
🔥 [STREAM] Sending balance update to frontend: 4255
🔍 ensureConversationExists called with: {
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  difyConversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "你好",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "conversation_id": "ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🔍 Looking up conversation in database: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
✅ Found existing DIFY conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
🔄 Continuing existing conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
📤 [DIFY API] Sending request to chat-messages: {
  query: '你好...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  timestamp: '2025-08-31T00:52:39.812Z'
}
📊 Context check: 424 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '97788be9699a182f-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sun, 31 Aug 2025 00:52:40 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=n3k6%2FTtsGXGnmJZciELAR8LCj2fX72qJR5mfxsWG%2BuVz%2BsQbsGydOzz7U%2Fqz7b%2Bvkq7C5JXPxjxMeZ%2FZzzC0lENvLivXK2FPQGcN6I0jQhltuM%2FqK2JF9RDChtLjBsMskEnCgUD39RIy"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=5688&min_rtt=3736&rtt_var=2795&sent=3&recv=5&lost=0&retrans=0&sent_bytes=234&recv_bytes=1210&delivery_rate=360813&cwnd=250&unsent_bytes=0&cid=bbb5924091428c04&ts=423&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 1853
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 1853 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.003898 = 39 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 39 points. Balance: 4207 → 4168
🔥 [STREAM] Sending balance update to frontend: 4168
🔍 ensureConversationExists called with: {
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  difyConversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "你好",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "conversation_id": "ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🔍 Looking up conversation in database: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
✅ Found existing DIFY conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
🔄 Continuing existing conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
📤 [DIFY API] Sending request to chat-messages: {
  query: '你好...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  timestamp: '2025-08-31T00:53:06.662Z'
}
📊 Context check: 424 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '97788c8e8c47aaed-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sun, 31 Aug 2025 00:53:07 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=TNEnwj29o8d9s7g6zjPl5ktGx0onfqh1lo7UYPdABIkHRd5MrhnnxZr5hbrga9260qBFg5gGJRXF48KUJn1qfb%2BRQLwNLn7FehuHoeygYWLY1RFdSEMu0Lxtt%2BOpSZWXUkUHhTlkaztV"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=7337&min_rtt=3631&rtt_var=3942&sent=3&recv=5&lost=0&retrans=0&sent_bytes=234&recv_bytes=1210&delivery_rate=371247&cwnd=250&unsent_bytes=0&cid=2a301cd533a5208e&ts=978&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 1888
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 1888 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.003968 = 40 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 40 points. Balance: 4119 → 4079
🔥 [STREAM] Sending balance update to frontend: 4079
🔍 ensureConversationExists called with: {
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  difyConversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "你好",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "conversation_id": "ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🔍 Looking up conversation in database: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
✅ Found existing DIFY conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
🔄 Continuing existing conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
📤 [DIFY API] Sending request to chat-messages: {
  query: '你好...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  timestamp: '2025-08-31T00:53:35.502Z'
}
📊 Context check: 424 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '97788d42afb85727-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sun, 31 Aug 2025 00:53:36 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=UEZLiUmswqamN6wW9R6JarkfzDIRy%2FkDL6XJXfMi8pnLvHy4lXyPIM3Rt5nz07lt0i4lciATLzzt4eV6rFKp8cVColmd37mbgIfNH%2BXn8i4NqOh%2F1OzRgXxipZVofq2ksxsFKUQR7Dsi"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=3917&min_rtt=3506&rtt_var=1608&sent=3&recv=5&lost=0&retrans=0&sent_bytes=234&recv_bytes=1210&delivery_rate=384483&cwnd=247&unsent_bytes=0&cid=730a68e719780744&ts=684&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 1923
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 1923 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.004038 = 41 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 41 points. Balance: 4079 → 4038
🔥 [STREAM] Sending balance update to frontend: 4038
🔍 ensureConversationExists called with: {
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  difyConversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "你好",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "conversation_id": "ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🔍 Looking up conversation in database: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
✅ Found existing DIFY conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
🔄 Continuing existing conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
📤 [DIFY API] Sending request to chat-messages: {
  query: '你好...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  timestamp: '2025-08-31T00:53:48.445Z'
}
📊 Context check: 424 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '97788d939db6a838-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sun, 31 Aug 2025 00:53:49 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=s3rN8FyfSuASgKOZmSqdPWuU8fShz4WB2NrUIKw1n%2BRNHk7BFDChzLiFsBNs9k9dmokoFK9K5%2BPjiDLSurzdTGJDB17DRVQ%2B0S09L5Wq5LuKchATu0zNUfaVIbiYWHk0w7%2FZiXaTABaj"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=4409&min_rtt=3993&rtt_var=2329&sent=3&recv=5&lost=0&retrans=0&sent_bytes=234&recv_bytes=1210&delivery_rate=184127&cwnd=250&unsent_bytes=0&cid=8b031a981c238e2b&ts=651&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 1958
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 1958 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.004108 = 42 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 42 points. Balance: 4038 → 3996
🔥 [STREAM] Sending balance update to frontend: 3996
🔍 ensureConversationExists called with: {
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  difyConversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "你好",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "conversation_id": "ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🔍 Looking up conversation in database: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
✅ Found existing DIFY conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
🔄 Continuing existing conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
📤 [DIFY API] Sending request to chat-messages: {
  query: '你好...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  timestamp: '2025-08-31T00:54:01.662Z'
}
📊 Context check: 424 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '97788de64d0ba973-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sun, 31 Aug 2025 00:54:02 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=Ui3iIDF6HWlG%2FCaygM4lvVHb0QzX8vkL0XG8ww%2FlX%2FiJY%2BHQ%2FxnEAUghM7EIfxNTUyHnofEf8a2Vyw4noJnsTh1o%2BZOyqGSAsRj8ZrwXsOQw%2FjAY5lN07BYixtU%2BKORb3rMfOdvKFV12"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=4730&min_rtt=3992&rtt_var=2974&sent=3&recv=5&lost=0&retrans=0&sent_bytes=234&recv_bytes=1210&delivery_rate=136120&cwnd=250&unsent_bytes=0&cid=82be3a2da5f9dda2&ts=626&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 1993
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 1993 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.004178 = 42 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 42 points. Balance: 3996 → 3954
🔥 [STREAM] Sending balance update to frontend: 3954
🔍 ensureConversationExists called with: {
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  difyConversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "你好",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "conversation_id": "ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🔍 Looking up conversation in database: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
✅ Found existing DIFY conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
🔄 Continuing existing conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
📤 [DIFY API] Sending request to chat-messages: {
  query: '你好...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  timestamp: '2025-08-31T00:54:48.144Z'
}
📊 Context check: 425 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '97788f08cbd77d6d-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sun, 31 Aug 2025 00:54:49 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=sccQCXK2z0bIyopTdBuchIkJeqT66pas%2BPMP2yjJvUCqhnpp9iNoam%2BMWFD8m5heodF%2FxZkt4NIR9YcTO4nvkHFHmiQ7xKVOi0X5ypHl6Q38nvnZwO1afcPEal17PdFxM1Hs1YZKu9ne"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=4880&min_rtt=4251&rtt_var=2043&sent=3&recv=5&lost=0&retrans=0&sent_bytes=234&recv_bytes=1210&delivery_rate=317101&cwnd=250&unsent_bytes=0&cid=851f830cbceb2992&ts=962&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 2028
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 2028 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.004248 = 43 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 43 points. Balance: 3902 → 3859
🔥 [STREAM] Sending balance update to frontend: 3859
🔍 ensureConversationExists called with: {
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  difyConversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "你好",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "conversation_id": "ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🔍 Looking up conversation in database: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
✅ Found existing DIFY conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
🔄 Continuing existing conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
📤 [DIFY API] Sending request to chat-messages: {
  query: '你好...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  timestamp: '2025-08-31T00:55:09.871Z'
}
📊 Context check: 426 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '97788f909ca5a959-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sun, 31 Aug 2025 00:55:10 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=frf22iRTWPFNtE97Mp0XZKGFT27YXZfhEjIpQv1Q4ugQ89Yczw%2FKSDCE6ke%2Bwk3WR7zbcMtpAmct3CORxtrrKHrrXfRlE7lz649cyOLwJSC1ndc5jv22WwMc2l%2Bb6VvIjpxuuIi7%2FLuh"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=10053&min_rtt=3980&rtt_var=5506&sent=3&recv=5&lost=0&retrans=0&sent_bytes=234&recv_bytes=1210&delivery_rate=338693&cwnd=250&unsent_bytes=0&cid=0293ad07249e1c18&ts=644&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 2063
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 2063 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.004318 = 44 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 44 points. Balance: 3806 → 3762
🔥 [STREAM] Sending balance update to frontend: 3762
🔍 ensureConversationExists called with: {
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  difyConversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "你好",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "conversation_id": "ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🔍 Looking up conversation in database: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
✅ Found existing DIFY conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
🔄 Continuing existing conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
📤 [DIFY API] Sending request to chat-messages: {
  query: '你好...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  timestamp: '2025-08-31T01:12:01.924Z'
}
📊 Context check: 427 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '9778a848abcaa95c-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sun, 31 Aug 2025 01:12:03 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=Y1FvoZMyJYLkPRrniEiOLxL9HZcdIPBEkYfI8aWTaUOI8poiO8vESPjnOAWkmWStJuql81sSTl0BJk048r3OKWL1EKvKR2fqhQ40NOBmm6w1DoAEf7MR8iruWTvju0n0G992%2FB2H2hfG"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=4879&min_rtt=4315&rtt_var=2021&sent=3&recv=5&lost=0&retrans=0&sent_bytes=234&recv_bytes=1210&delivery_rate=312398&cwnd=250&unsent_bytes=0&cid=4bdba8ecbd1ce750&ts=974&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 2098
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 2098 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.004388 = 44 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 44 points. Balance: 3762 → 3718
🔥 [STREAM] Sending balance update to frontend: 3718
🔍 ensureConversationExists called with: {
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  difyConversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "你好",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "conversation_id": "ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🔍 Looking up conversation in database: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
✅ Found existing DIFY conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
🔄 Continuing existing conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
📤 [DIFY API] Sending request to chat-messages: {
  query: '你好...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  timestamp: '2025-08-31T01:12:47.658Z'
}
📊 Context check: 427 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '9778a9650d70344e-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sun, 31 Aug 2025 01:12:48 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=mZxpuA2JqvfvyXif7Lpj83Ga4IC0VOGGJFHbaSuTKaK5cugT3IrO4p%2FO34d%2FMnmbmcNhO7ubTfFNLsv3ylDbsgdifAnhoIxiGAYNoVT79gSRx%2BXRcSt9kLt31v1fjQomJJ%2FzvyFpydUO"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=4246&min_rtt=3940&rtt_var=2090&sent=3&recv=5&lost=0&retrans=0&sent_bytes=234&recv_bytes=1210&delivery_rate=210855&cwnd=247&unsent_bytes=0&cid=38fd087ccf1cecb9&ts=696&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 2133
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 2133 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.004458 = 45 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 45 points. Balance: 3718 → 3673
🔥 [STREAM] Sending balance update to frontend: 3673
🔍 ensureConversationExists called with: {
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  difyConversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "你好",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "conversation_id": "ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🔍 Looking up conversation in database: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
✅ Found existing DIFY conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
🔄 Continuing existing conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
📤 [DIFY API] Sending request to chat-messages: {
  query: '你好...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  timestamp: '2025-08-31T01:13:28.730Z'
}
📊 Context check: 427 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '9778aa64ae27a801-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sun, 31 Aug 2025 01:13:30 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=vtTydD1NR1X2oqEd3X5HH0jRqwyDJBg8QDqk56qK98NhTCt6LgFS85mhQmxGUN5fpf97SCG5nW1K%2F3D0j%2Fot2GtfDvHj3eADk5NEgOX%2FMld78Em178ZpYcjxxNZeiUUR5nB7i5kqRbp6"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=5094&min_rtt=4971&rtt_var=2110&sent=5&recv=5&lost=0&retrans=0&sent_bytes=2827&recv_bytes=939&delivery_rate=679093&cwnd=252&unsent_bytes=0&cid=d10d8f9cc8c829bd&ts=972&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 2168
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 2168 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.004528 = 46 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 46 points. Balance: 3673 → 3627
🔥 [STREAM] Sending balance update to frontend: 3627
🔍 ensureConversationExists called with: {
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  difyConversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "你好",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "conversation_id": "ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🔍 Looking up conversation in database: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
✅ Found existing DIFY conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
🔄 Continuing existing conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
📤 [DIFY API] Sending request to chat-messages: {
  query: '你好...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  timestamp: '2025-08-31T01:15:59.928Z'
}
📊 Context check: 427 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '9778ae155c8ce7ce-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sun, 31 Aug 2025 01:16:01 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=dslUl0m%2BTGtL0QjkWmI8KGmDglj4jBjc0aRx6mB1GwLjbHI1MpaIDkMIK%2FzCU4hVRmL2KKRfKo4Se65euavuZlh63A2zrmXOmsqSIMearGpzzjOQsFwCo94hKZl%2Fqrr4OcDdQPBG7%2F%2Fn"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=4312&min_rtt=3956&rtt_var=2197&sent=3&recv=5&lost=0&retrans=0&sent_bytes=234&recv_bytes=1210&delivery_rate=197944&cwnd=250&unsent_bytes=0&cid=dad22a0079925ea3&ts=951&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 2203
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 2203 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.004598 = 46 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 46 points. Balance: 3627 → 3581
🔥 [STREAM] Sending balance update to frontend: 3581
🔍 ensureConversationExists called with: {
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  difyConversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "你好",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "conversation_id": "ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🔍 Looking up conversation in database: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
✅ Found existing DIFY conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
🔄 Continuing existing conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
📤 [DIFY API] Sending request to chat-messages: {
  query: '你好...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  timestamp: '2025-08-31T01:16:12.894Z'
}
📊 Context check: 427 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '9778ae66ade9a97d-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sun, 31 Aug 2025 01:16:13 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=GIN83g0vq%2FkHISVoUUqQU0bPnkcvFq2ZpJYfJVEi%2FJaWqMd3F%2F9rHx0QZwx06n4vn2sWCLXG8RFrB5jivkI55CqacG8vO6VBWANgK988rJ%2BItJrTCG843IwSfKxolFxdn%2FFy4YnNH2Q5"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=4130&min_rtt=3973&rtt_var=1804&sent=3&recv=5&lost=0&retrans=0&sent_bytes=234&recv_bytes=1210&delivery_rate=257694&cwnd=251&unsent_bytes=0&cid=02377b527ee6767d&ts=674&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 2238
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 2238 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.004668 = 47 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 47 points. Balance: 3581 → 3534
🔥 [STREAM] Sending balance update to frontend: 3534
🔍 ensureConversationExists called with: {
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  difyConversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "你好",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "conversation_id": "ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🔍 Looking up conversation in database: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
✅ Found existing DIFY conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
🔄 Continuing existing conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
📤 [DIFY API] Sending request to chat-messages: {
  query: '你好...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  timestamp: '2025-08-31T01:19:27.197Z'
}
📊 Context check: 427 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '9778b3250a02ab05-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sun, 31 Aug 2025 01:19:28 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=0cIqZVYgvW4FJEjotmAjbdVyEsXnNGYf%2Ffv0KGaGd4c61xokpCXwihmTT%2BGu1U2BKmFiy4n2nc6%2FfobrK3Cmil9OQkQX8SMLvHvrPJcH5zIDhvEIrysNU5T%2BMXTIax9GmD6%2Bl9yYeW14"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=5411&min_rtt=4979&rtt_var=2731&sent=3&recv=5&lost=0&retrans=0&sent_bytes=234&recv_bytes=1210&delivery_rate=159810&cwnd=250&unsent_bytes=0&cid=3efd401dd624d5c9&ts=1024&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 2273
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 2273 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.004738 = 48 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 48 points. Balance: 3534 → 3486
🔥 [STREAM] Sending balance update to frontend: 3486
🔍 ensureConversationExists called with: {
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  difyConversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "你好",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "conversation_id": "ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🔍 Looking up conversation in database: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
✅ Found existing DIFY conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
🔄 Continuing existing conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
📤 [DIFY API] Sending request to chat-messages: {
  query: '你好...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  timestamp: '2025-08-31T01:20:10.969Z'
}
📊 Context check: 427 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '9778b4376ab798ec-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sun, 31 Aug 2025 01:20:12 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=srd34JlEyjhW9wpR2YisqjBuHfEJqkRnXaSPAN0mdRIwwnWobti41aGO5LazTfx7%2F5ycB1TYvjDxQC9fP0KOHXBpQpinzq1kf3tnDVx0uw2bcMLmux3jBbcurdG8usC43ldd5vpbie3H"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=4808&min_rtt=3861&rtt_var=2124&sent=3&recv=5&lost=0&retrans=0&sent_bytes=234&recv_bytes=1210&delivery_rate=349132&cwnd=249&unsent_bytes=0&cid=5ad5058b108b5dd3&ts=630&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 2308
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 2308 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.004808 = 49 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 49 points. Balance: 3427 → 3378
🔥 [STREAM] Sending balance update to frontend: 3378
🔍 ensureConversationExists called with: {
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  difyConversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "你好",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "conversation_id": "ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🔍 Looking up conversation in database: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
✅ Found existing DIFY conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
🔄 Continuing existing conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
📤 [DIFY API] Sending request to chat-messages: {
  query: '你好...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  timestamp: '2025-08-31T01:37:55.784Z'
}
📊 Context check: 427 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '9778ce3c5cafab01-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sun, 31 Aug 2025 01:37:58 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=4RpilJyKjp8eXkHFKKMny%2FSjbfqm0X5gAxft%2FQtgYtRTunvPucQeVgMRPm2fOAqVceK7D5SWM3y9QmBNNXWRYgjrmQKcOCUuaeGbE%2FhkrKiWn3CGbUtfDZdUsO0NBFoXwbNuUPFdR9MA"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=4051&min_rtt=3955&rtt_var=1676&sent=4&recv=6&lost=0&retrans=0&sent_bytes=234&recv_bytes=1210&delivery_rate=285109&cwnd=250&unsent_bytes=0&cid=1313f042bf77b3b3&ts=931&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 2343
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 2343 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.004878 = 49 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 49 points. Balance: 3318 → 3269
🔥 [STREAM] Sending balance update to frontend: 3269
🔍 ensureConversationExists called with: {
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  difyConversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "你好",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "conversation_id": "ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🔍 Looking up conversation in database: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
✅ Found existing DIFY conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
🔄 Continuing existing conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
📤 [DIFY API] Sending request to chat-messages: {
  query: '你好...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  timestamp: '2025-08-31T01:41:46.752Z'
}
📊 Context check: 427 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '9778d3d9c8c7dc10-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sun, 31 Aug 2025 01:41:48 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=47aGxd%2FW0ITBheQRNuGln0Lxr5D770DOENZSjTkSs%2FqBJiBrOqLtYn72bFXPH9nLvE2iZtc1z4BTblj5LE64hiQSTuMZOivtnzB7zpD%2Fk1RYYZVxLyFLVN7cWiWPwtN1mgHbBgmfPPVf"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=3935&min_rtt=3563&rtt_var=1602&sent=3&recv=5&lost=0&retrans=0&sent_bytes=234&recv_bytes=1210&delivery_rate=378332&cwnd=246&unsent_bytes=0&cid=3996b6eb1d6f4acb&ts=1028&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 2378
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 2378 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.004948 = 50 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 50 points. Balance: 3269 → 3219
🔥 [STREAM] Sending balance update to frontend: 3219
🔍 ensureConversationExists called with: {
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  difyConversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "你好",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "conversation_id": "ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🔍 Looking up conversation in database: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
✅ Found existing DIFY conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
🔄 Continuing existing conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
📤 [DIFY API] Sending request to chat-messages: {
  query: '你好...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  timestamp: '2025-08-31T01:42:02.310Z'
}
📊 Context check: 427 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '9778d43b2d62e7c1-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sun, 31 Aug 2025 01:42:03 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=G4e%2FPeZg5sLJaVwUhcLOlEh4v%2FZ%2Bw3UXgmyRQtQpQqgbdA5XTyFkm%2FEWJ4mxmOFhtj2S%2FkIz%2BdRZMITiy7BTslxRXOYqhpuDnkYGDrbMvry0Focz2ENYt%2B9jAUQXIkbTrqf%2BbxMWvOfJ"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=4015&min_rtt=3967&rtt_var=1585&sent=3&recv=5&lost=0&retrans=0&sent_bytes=234&recv_bytes=1210&delivery_rate=309458&cwnd=250&unsent_bytes=0&cid=22288f98a75f6869&ts=698&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 2413
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 2413 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.005018 = 51 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 51 points. Balance: 3157 → 3106
🔥 [STREAM] Sending balance update to frontend: 3106
🔍 ensureConversationExists called with: {
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  difyConversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "你好",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "conversation_id": "ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🔍 Looking up conversation in database: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
✅ Found existing DIFY conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
🔄 Continuing existing conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
📤 [DIFY API] Sending request to chat-messages: {
  query: '你好...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  timestamp: '2025-08-31T01:42:23.098Z'
}
📊 Context check: 427 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '9778d4bd39c4aaef-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sun, 31 Aug 2025 01:42:24 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=YkyYJ6xt167uL3TWf%2BpU2z46B%2Bc8kmtynxRwS%2FKgm0xpcJYqhh0xpwNqjw5LinnamPcnhIyRmIFl3fd%2Fa9u5vDoJ7Wm3Y7BR%2BqBT0tvmXChlqgglvCi65n7yMieVMQpMBFghPqKpL%2BqI"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=3969&min_rtt=3941&rtt_var=1498&sent=3&recv=5&lost=0&retrans=0&sent_bytes=234&recv_bytes=1210&delivery_rate=342045&cwnd=250&unsent_bytes=0&cid=33229f15ae593998&ts=640&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 2448
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 2448 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.005088 = 51 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 51 points. Balance: 3043 → 2992
🔥 [STREAM] Sending balance update to frontend: 2992
🔍 ensureConversationExists called with: {
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  difyConversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "产品：户外写生课。特色：学生不仅具备扎实的绘画技法，更重要的是形成了敏锐的视觉观察力、准确的美学判断力和独特的艺术表达力，为终身的艺术发展奠定坚实基础。用户目标是有给5-16岁孩子报绘画课的家长或者正在寻找优质的绘画课，或者想要换掉绘画老师的家长 ，价格是80澳币每节课，每节课2小时， 包含材料， 一学期是800澳币，直接销售，口播文案，1000字左右",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "conversation_id": "ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🔍 Looking up conversation in database: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
✅ Found existing DIFY conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
🔄 Continuing existing conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
📤 [DIFY API] Sending request to chat-messages: {
  query: '产品：户外写生课。特色：学生不仅具备扎实的绘画技法，更重要的是形成了敏锐的视觉观察力、准确的美学判断力和独特的艺术表达力，为终身的艺术发展奠定坚实基础。用户目标是有给5-16岁孩子报绘画课的家长或者正...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  timestamp: '2025-08-31T01:42:49.870Z'
}
📊 Context check: 621 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '9778d56478915c06-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sun, 31 Aug 2025 01:42:51 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=Ohft5eEf%2FB1pbxKyt5c1cmJl6eJiJ0kL9cbsQI0VD9gHO7PjCHBXAwhBzfzQDbZ2HmW0e2l96m9J29r9V5oRlFxdu1dv96leqrxcHHQ3QmOPrOxJR8XxNho00CqAtJbXZ6IyrJZVCWlM"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=4040&min_rtt=3991&rtt_var=1595&sent=3&recv=5&lost=0&retrans=0&sent_bytes=234&recv_bytes=1701&delivery_rate=307341&cwnd=251&unsent_bytes=0&cid=2ebe868fb7fa68d3&ts=749&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 2909
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 2909 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.006592 = 66 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 66 points. Balance: 2928 → 2862
🔥 [STREAM] Sending balance update to frontend: 2862
🔍 ensureConversationExists called with: {
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  difyConversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "你哈",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "conversation_id": "ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🔍 Looking up conversation in database: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
✅ Found existing DIFY conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
🔄 Continuing existing conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
📤 [DIFY API] Sending request to chat-messages: {
  query: '你哈...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  timestamp: '2025-08-31T01:43:21.670Z'
}
📊 Context check: 622 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '9778d62afffca94f-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sun, 31 Aug 2025 01:43:22 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=rA56qmINaaWeF2EHIzXxbz3bKB%2FYZYXVlj5HgS%2BoKKBwzr6CHlQrBO6IJE6%2BrVDkeHdTAAJbhW15cKf8vsYcuwkFWvekGg%2FyQwQmrC16iIisr7eMwdAsWnzAQOs%2FFHRcKgkKmxBojQGV"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=5051&min_rtt=4965&rtt_var=2035&sent=3&recv=5&lost=0&retrans=0&sent_bytes=234&recv_bytes=1210&delivery_rate=238246&cwnd=250&unsent_bytes=0&cid=3c16ecf551ff216b&ts=693&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 5692
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 5692 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.017162 = 172 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 172 points. Balance: 2862 → 2690
🔥 [STREAM] Sending balance update to frontend: 2690
🔍 ensureConversationExists called with: {
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  difyConversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "你好",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "conversation_id": "ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🔍 Looking up conversation in database: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
✅ Found existing DIFY conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
🔄 Continuing existing conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
📤 [DIFY API] Sending request to chat-messages: {
  query: '你好...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  timestamp: '2025-08-31T01:45:16.797Z'
}
📊 Context check: 622 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '9778d8fcc88ee7c9-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sun, 31 Aug 2025 01:45:18 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=JIK0XBxoNg1q51p9dT1TB%2BhXASXMDb0STCRQHVoi%2B20eJA3e%2FzmKqKB9zp4oRsJQij95EAj41Su3uQnm2mqwa1E7gMdNv1OypSXzvwvtbJVWgQ54lCgfw6Sfr8hMpnnVMz1FAokuFeKO"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=3905&min_rtt=3360&rtt_var=1649&sent=3&recv=5&lost=0&retrans=0&sent_bytes=234&recv_bytes=1210&delivery_rate=401190&cwnd=250&unsent_bytes=0&cid=916a94d6d2a807ae&ts=943&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 6062
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 6062 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.000726 = 8 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 8 points. Balance: 2475 → 2467
🔥 [STREAM] Sending balance update to frontend: 2467
🔍 ensureConversationExists called with: {
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  difyConversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "你好",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "conversation_id": "ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🔍 Looking up conversation in database: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
✅ Found existing DIFY conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
🔄 Continuing existing conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
📤 [DIFY API] Sending request to chat-messages: {
  query: '你好...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  timestamp: '2025-08-31T01:45:32.222Z'
}
📊 Context check: 622 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '9778d95b8c16a6d9-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sun, 31 Aug 2025 01:45:33 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=EmDhrhlwlMbxL61nrd8DiAsV614NvmpKUJqQucyoaeHe1PlgNKQTipNuKO2vjarVvtVdNljsgSUk15mLWPYLtol5SZv4mUaTtMz8F5wC76mH%2FBqBpthHH0atwRZHUQQa6UL7ewKS%2BPiH"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=6640&min_rtt=4348&rtt_var=3268&sent=3&recv=5&lost=0&retrans=0&sent_bytes=234&recv_bytes=1210&delivery_rate=310027&cwnd=250&unsent_bytes=0&cid=7907a612719fbb0c&ts=622&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 6533
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 6533 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.000786 = 8 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 8 points. Balance: 2467 → 2459
🔥 [STREAM] Sending balance update to frontend: 2459
🔍 ensureConversationExists called with: {
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  difyConversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "你好",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "conversation_id": "ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🔍 Looking up conversation in database: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
✅ Found existing DIFY conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
🔄 Continuing existing conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
📤 [DIFY API] Sending request to chat-messages: {
  query: '你好...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  timestamp: '2025-08-31T01:45:47.623Z'
}
📊 Context check: 622 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '9778d9bb1f61e7dd-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sun, 31 Aug 2025 01:45:48 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=UyD8gzDPrSZWkQY5aAOKCBtfrY875rKySrC6Up%2BFmgtwH4pdrSdfc82WyHuhf6dgplUaCMUQrtnwDx9RiqSI7wVTnBCsxFzsKnijA%2FVxG75illAirHCM90hKSKjl9l3q%2BNVb%2FnKnhlmd"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=3958&min_rtt=3836&rtt_var=1526&sent=3&recv=5&lost=0&retrans=0&sent_bytes=234&recv_bytes=1210&delivery_rate=351407&cwnd=250&unsent_bytes=0&cid=1025bdf29dca2c45&ts=627&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 6996
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 6996 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.000830 = 9 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 9 points. Balance: 2459 → 2450
🔥 [STREAM] Sending balance update to frontend: 2450
🔍 ensureConversationExists called with: {
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  difyConversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "你好",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "conversation_id": "ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🔍 Looking up conversation in database: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
✅ Found existing DIFY conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
🔄 Continuing existing conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
📤 [DIFY API] Sending request to chat-messages: {
  query: '你好...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  timestamp: '2025-08-31T01:46:13.240Z'
}
📊 Context check: 622 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '9778da5c9907573f-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sun, 31 Aug 2025 01:46:14 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=LeVMnhoE6T2P1Z0Z4IEsRWwu4T3OlIFb9z8GSPH22%2FvgM4ksNvOMn94Eo4WTTfD5GEf5LR8fpxkB2xcdO%2FquqjxxyGuGWNjOfVRCW55bJlehIFYxL8dXv%2FjZSu1ApeY2PNcGyZur3D5S"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=3847&min_rtt=3078&rtt_var=1703&sent=3&recv=5&lost=0&retrans=0&sent_bytes=234&recv_bytes=1210&delivery_rate=437946&cwnd=250&unsent_bytes=0&cid=e47de20cd810f609&ts=633&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 7513
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 7513 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.000898 = 9 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 9 points. Balance: 2450 → 2441
🔥 [STREAM] Sending balance update to frontend: 2441
🔍 ensureConversationExists called with: {
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  difyConversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "你哈",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "conversation_id": "ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🔍 Looking up conversation in database: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
✅ Found existing DIFY conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
🔄 Continuing existing conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
📤 [DIFY API] Sending request to chat-messages: {
  query: '你哈...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  timestamp: '2025-08-31T01:49:22.557Z'
}
📊 Context check: 622 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '9778defaee49e7cc-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sun, 31 Aug 2025 01:49:23 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=yDVFP0cX6NSOMS%2FD1BRZckNtKHVzhk5UV57aqedUrk3t8Hi9RYmOQV29ER%2Bn0Fi5GIXr07HXHAHI86m8PiwySHebbOMOPCjzjwcm3%2BZlEXtMQst9qIkvuTswYWm%2FRL0cSxUwrvpfjV%2BA"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=6809&min_rtt=5207&rtt_var=3097&sent=3&recv=5&lost=0&retrans=0&sent_bytes=234&recv_bytes=1210&delivery_rate=258882&cwnd=250&unsent_bytes=0&cid=df9e35550606e226&ts=986&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 7984
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 7984 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.000930 = 10 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 10 points. Balance: 2439 → 2429
🔥 [STREAM] Sending balance update to frontend: 2429
🔍 ensureConversationExists called with: {
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  difyConversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "你好",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "conversation_id": "ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🔍 Looking up conversation in database: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
✅ Found existing DIFY conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
🔄 Continuing existing conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
📤 [DIFY API] Sending request to chat-messages: {
  query: '你好...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  timestamp: '2025-08-31T01:50:53.472Z'
}
📊 Context check: 622 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '9778e132db5a5f25-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sun, 31 Aug 2025 01:50:54 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=Yq96jTp8%2Blo6TsegtpQCy9LvQdq3o1rrbmS%2BqOGbgdcaMrtsHD%2B0cxavDL1Hbxw%2F4EPOhaU4DBMx8s2DiMnnsOP46qcDB8v0JKKSbtbZ4K10mNg%2BYHAWJYEzII9Ru7HPU3TWzmsUv43X"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=4874&min_rtt=4167&rtt_var=2067&sent=3&recv=5&lost=0&retrans=0&sent_bytes=234&recv_bytes=1210&delivery_rate=323494&cwnd=248&unsent_bytes=0&cid=dce9d5a3fdf87c37&ts=945&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 8469
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 8469 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.000984 = 10 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 10 points. Balance: 2429 → 2419
🔥 [STREAM] Sending balance update to frontend: 2419
🔍 ensureConversationExists called with: {
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  difyConversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "你好",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "conversation_id": "ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🔍 Looking up conversation in database: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
✅ Found existing DIFY conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
🔄 Continuing existing conversation: ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda
📤 [DIFY API] Sending request to chat-messages: {
  query: '你好...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  timestamp: '2025-08-31T01:56:36.125Z'
}
📊 Context check: 622 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '9778e990ced57e43-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sun, 31 Aug 2025 01:56:37 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=HHArg8e1cC%2FY6ClNQbkN4hf1oHs2zPiiQyI6A63R67WMRY8RBuacFC722rAn9MoZJ7EuT4U16wqssuxVQBCG%2FKGPFigRGh86i0jxSJBNAP1szPZ4KlpM6z9FK1DzN6Ye%2F7UlPDda%2B4%2FI"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=3993&min_rtt=3944&rtt_var=1514&sent=3&recv=5&lost=0&retrans=0&sent_bytes=234&recv_bytes=1210&delivery_rate=341784&cwnd=250&unsent_bytes=0&cid=9a7b994c682ebac5&ts=952&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 8949
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 8949 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.001030 = 11 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 11 points. Balance: 2419 → 2408
🔥 [STREAM] Sending balance update to frontend: 2408
🔍 ensureConversationExists called with: {
  conversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  difyConversationId: 'ca7a3d49-b4c0-425f-b1bb-7b09d5a5edda',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "你好",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🆕 Generated new conversation UUID: 3d146dee-77a7-4665-923f-6cf94220ba9c
🔍 Looking up conversation in database: 3d146dee-77a7-4665-923f-6cf94220ba9c
📝 No existing conversation found for: 3d146dee-77a7-4665-923f-6cf94220ba9c
🆕 Starting new conversation - letting DIFY initialize conversation variables
📤 [DIFY API] Sending request to chat-messages: {
  query: '你好...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: 'NEW_CONVERSATION',
  timestamp: '2025-08-31T03:20:16.421Z'
}
📊 New conversation, no context management needed
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '97796421df49e7de-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sun, 31 Aug 2025 03:20:18 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=r53Py9%2FRbNBWFblBisFr6yKFqslzNKnxF%2FCSNpmltgrH%2FhYlniujqxFrAcaOr5QpdUMOF3i1UYqq8XYkD3plOLsskX7pg18QszUD8uljy3ZCLIBpnRt7c4lFdaV5or2DTbfBmAPWKkXX"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=3995&min_rtt=3984&rtt_var=1517&sent=3&recv=5&lost=0&retrans=0&sent_bytes=234&recv_bytes=1153&delivery_rate=330473&cwnd=250&unsent_bytes=0&cid=2d95179a750d07f4&ts=1133&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 938
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 938 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.002068 = 21 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 21 points. Balance: 2408 → 2387
🔥 [STREAM] Sending balance update to frontend: 2387
🔍 ensureConversationExists called with: {
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  difyConversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Verified user exists in database: 9dee4891-89a6-44ee-8fe8-69097846e97d
✅ Created new conversation record
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "你好",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "conversation_id": "1ffd3862-15bb-4d76-a74f-3576ce42d998",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🔍 Looking up conversation in database: 1ffd3862-15bb-4d76-a74f-3576ce42d998
✅ Found existing DIFY conversation: 1ffd3862-15bb-4d76-a74f-3576ce42d998
🔄 Continuing existing conversation: 1ffd3862-15bb-4d76-a74f-3576ce42d998
📤 [DIFY API] Sending request to chat-messages: {
  query: '你好...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  timestamp: '2025-08-31T03:25:31.299Z'
}
📊 Context check: 20 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '97796bd1bbc54dd5-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sun, 31 Aug 2025 03:25:32 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=nTVnm4Ux2ejbiaMRjp6Ua1TK%2FF7pkhhx1DF6TpR2SmjUeL8I3253ZCuwnDeJptELseFiZ9ugs6vhibJmQPHxgTQNX7ULwTMXhO7b6Dw6NBFn4SRkW%2BcDfoekdWGt9iY1V1jaNKXjyQQZ"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=4038&min_rtt=4010&rtt_var=1524&sent=3&recv=5&lost=0&retrans=0&sent_bytes=234&recv_bytes=1210&delivery_rate=336159&cwnd=250&unsent_bytes=0&cid=b4ad81f357d545b3&ts=963&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 963
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 963 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.002094 = 21 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 21 points. Balance: 2361 → 2340
🔥 [STREAM] Sending balance update to frontend: 2340
🔍 ensureConversationExists called with: {
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  difyConversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "你好",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "conversation_id": "1ffd3862-15bb-4d76-a74f-3576ce42d998",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🔍 Looking up conversation in database: 1ffd3862-15bb-4d76-a74f-3576ce42d998
✅ Found existing DIFY conversation: 1ffd3862-15bb-4d76-a74f-3576ce42d998
🔄 Continuing existing conversation: 1ffd3862-15bb-4d76-a74f-3576ce42d998
📤 [DIFY API] Sending request to chat-messages: {
  query: '你好...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  timestamp: '2025-08-31T03:25:44.021Z'
}
📊 Context check: 37 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '97796c21cea75f22-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sun, 31 Aug 2025 03:25:45 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=DYyB8QBU5K7F0EMEY4hRcuePsGb1j95tpxHZaEGe5w%2BXg12Vg9hAP%2FeFPlwvWxGu56Oa88OVQ6f4HMpcApGJMh3kobAO96WbB5DbvwHcrHFxy97TJkdcq%2FI%2BArmJ1Z%2FS5ntUHsvhoWzS"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=4814&min_rtt=3720&rtt_var=2177&sent=3&recv=5&lost=0&retrans=0&sent_bytes=234&recv_bytes=1210&delivery_rate=362365&cwnd=250&unsent_bytes=0&cid=b59c8dc5f6213649&ts=710&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 994
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 994 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.002156 = 22 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 22 points. Balance: 2314 → 2292
🔥 [STREAM] Sending balance update to frontend: 2292
🔍 ensureConversationExists called with: {
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  difyConversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "你好",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "conversation_id": "1ffd3862-15bb-4d76-a74f-3576ce42d998",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🔍 Looking up conversation in database: 1ffd3862-15bb-4d76-a74f-3576ce42d998
✅ Found existing DIFY conversation: 1ffd3862-15bb-4d76-a74f-3576ce42d998
🔄 Continuing existing conversation: 1ffd3862-15bb-4d76-a74f-3576ce42d998
📤 [DIFY API] Sending request to chat-messages: {
  query: '你好...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  timestamp: '2025-08-31T03:31:53.221Z'
}
📊 Context check: 54 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '97797524deadaaf0-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sun, 31 Aug 2025 03:31:54 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=h2fUBI4roVrXreuVGY%2BAwpTKVPQi4dWeOKlG8v64E7rzRSl7NQu%2FArD1zlBtn8dyXU6GoyostSWry1xbYeWbOChQ7BA7GdqwJzegYcsmxatgnQ4K8%2B1NTx%2BX%2F431z66r5EIngVky9stk"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=6605&min_rtt=4045&rtt_var=3345&sent=3&recv=5&lost=0&retrans=0&sent_bytes=234&recv_bytes=1210&delivery_rate=333250&cwnd=250&unsent_bytes=0&cid=bb48852e8c6f7261&ts=952&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 1025
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 1025 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.002218 = 23 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 23 points. Balance: 2292 → 2269
🔥 [STREAM] Sending balance update to frontend: 2269
🔍 ensureConversationExists called with: {
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  difyConversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "你好",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "conversation_id": "1ffd3862-15bb-4d76-a74f-3576ce42d998",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🔍 Looking up conversation in database: 1ffd3862-15bb-4d76-a74f-3576ce42d998
✅ Found existing DIFY conversation: 1ffd3862-15bb-4d76-a74f-3576ce42d998
🔄 Continuing existing conversation: 1ffd3862-15bb-4d76-a74f-3576ce42d998
📤 [DIFY API] Sending request to chat-messages: {
  query: '你好...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  timestamp: '2025-08-31T03:32:04.842Z'
}
📊 Context check: 71 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '9779756d59a83d32-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sun, 31 Aug 2025 03:32:05 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=gBtSatHqrGI0p3AkBMDd%2F7GJG7hq5I9SkmGTr1jgTs98oCXHEHDvXiGBqYW1GDZhBiVBMVcCVzp4I9l1WmGeWetQ%2F7qkQDtYKYTfUoBiNWsqh5GufHRnRk0YZhESoiTOTodtaAVzi0CE"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=3966&min_rtt=3932&rtt_var=1499&sent=3&recv=5&lost=0&retrans=0&sent_bytes=234&recv_bytes=1210&delivery_rate=342828&cwnd=250&unsent_bytes=0&cid=77790fee50f36be3&ts=657&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 1056
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 1056 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.002280 = 23 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 23 points. Balance: 2241 → 2218
🔥 [STREAM] Sending balance update to frontend: 2218
🔍 ensureConversationExists called with: {
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  difyConversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "你好",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "conversation_id": "1ffd3862-15bb-4d76-a74f-3576ce42d998",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🔍 Looking up conversation in database: 1ffd3862-15bb-4d76-a74f-3576ce42d998
✅ Found existing DIFY conversation: 1ffd3862-15bb-4d76-a74f-3576ce42d998
🔄 Continuing existing conversation: 1ffd3862-15bb-4d76-a74f-3576ce42d998
📤 [DIFY API] Sending request to chat-messages: {
  query: '你好...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  timestamp: '2025-08-31T03:32:14.231Z'
}
📊 Context check: 88 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '977975a7fb88aad2-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sun, 31 Aug 2025 03:32:15 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=jFBzc38Q%2BLLb5X1FMacBTRoDymKymSAeDKln6Whqkqyb6pRSHy%2FCWHcFLzDiNPwQVj%2FeY26mFJVn%2BWKo0ZRf%2B7waoUd4cZoPpKrRfxsqloe7TeN4bywNNUWhKMNDHeBNjpp3pFLgLIQ2"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=3918&min_rtt=3419&rtt_var=1639&sent=3&recv=5&lost=0&retrans=0&sent_bytes=234&recv_bytes=1210&delivery_rate=394267&cwnd=250&unsent_bytes=0&cid=f053c2da352b3545&ts=664&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 1087
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 1087 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.002342 = 24 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 24 points. Balance: 2218 → 2194
🔥 [STREAM] Sending balance update to frontend: 2194
🔍 ensureConversationExists called with: {
  conversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  difyConversationId: '1ffd3862-15bb-4d76-a74f-3576ce42d998',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "niha",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🆕 Generated new conversation UUID: 27b09112-fb2e-48be-bcbd-609b13c4cc5f
🔍 Looking up conversation in database: 27b09112-fb2e-48be-bcbd-609b13c4cc5f
📝 No existing conversation found for: 27b09112-fb2e-48be-bcbd-609b13c4cc5f
🆕 Starting new conversation - letting DIFY initialize conversation variables
📤 [DIFY API] Sending request to chat-messages: {
  query: 'niha...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: 'NEW_CONVERSATION',
  timestamp: '2025-08-31T03:33:16.957Z'
}
📊 New conversation, no context management needed
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '977977300839a947-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sun, 31 Aug 2025 03:33:18 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=trgNAur8bwWBWneSCNo%2B4iMPlqY3398i7ICoM3OSzryh1DIJDqoZBOBG00%2BHXx2cJOyAarK%2BVFLfASTniBW3pFryhm%2FYvtrMs%2F9FS%2B3FkmrgWut1MxhdJ18p37pIht8lZ0g6fOb7K91f"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=3905&min_rtt=3404&rtt_var=1634&sent=5&recv=5&lost=0&retrans=0&sent_bytes=2828&recv_bytes=880&delivery_rate=1188014&cwnd=252&unsent_bytes=0&cid=098b068d670e5ecb&ts=1054&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 940
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 940 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.002066 = 21 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 21 points. Balance: 2194 → 2173
🔥 [STREAM] Sending balance update to frontend: 2173
🔍 ensureConversationExists called with: {
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  difyConversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Verified user exists in database: 9dee4891-89a6-44ee-8fe8-69097846e97d
✅ Created new conversation record
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "nihao",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "conversation_id": "836f4898-d32a-4173-8bf9-beeead7ae6f5",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🔍 Looking up conversation in database: 836f4898-d32a-4173-8bf9-beeead7ae6f5
✅ Found existing DIFY conversation: 836f4898-d32a-4173-8bf9-beeead7ae6f5
🔄 Continuing existing conversation: 836f4898-d32a-4173-8bf9-beeead7ae6f5
📤 [DIFY API] Sending request to chat-messages: {
  query: 'nihao...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  timestamp: '2025-08-31T03:33:23.328Z'
}
📊 Context check: 17 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '97797757be17a947-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sun, 31 Aug 2025 03:33:24 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=xY8C8hrx%2Bvx8yjlOR%2BsDaXl4izRIS%2Bz4X6olxaCGbearrw%2FHNyUA76dfZt047s1Zk0H0OO1mmJoWGfkDmE6d%2Fd6EGbDc0UKHj%2Bhty7qZLrYYWreCYNV7OL0ZDTURim8BF65IMqLyS2Hx"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=109315&min_rtt=2880&rtt_var=128279&sent=69&recv=48&lost=0&retrans=4&sent_bytes=44104&recv_bytes=1354&delivery_rate=2373836&cwnd=256&unsent_bytes=0&cid=098b068d670e5ecb&ts=6763&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 975
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 975 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.002136 = 22 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 22 points. Balance: 2147 → 2125
🔥 [STREAM] Sending balance update to frontend: 2125
🔍 ensureConversationExists called with: {
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  difyConversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "nihao",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "conversation_id": "836f4898-d32a-4173-8bf9-beeead7ae6f5",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🔍 Looking up conversation in database: 836f4898-d32a-4173-8bf9-beeead7ae6f5
✅ Found existing DIFY conversation: 836f4898-d32a-4173-8bf9-beeead7ae6f5
🔄 Continuing existing conversation: 836f4898-d32a-4173-8bf9-beeead7ae6f5
📤 [DIFY API] Sending request to chat-messages: {
  query: 'nihao...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  timestamp: '2025-08-31T03:33:34.100Z'
}
📊 Context check: 33 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '9779779b4e92a825-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sun, 31 Aug 2025 03:33:35 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=cl%2F3mXHr9YiD8rNdlVm3ZAvrWJOX74uuRs140iouSSwD2ESY2TmhetNEhu7mtzJPsOUTTLjmPWUjL9TYyfuEboqoi76LOpCaesjBaak9voYMEagBV8MPWBIDC4%2Fu7%2Fj30mjf3gzNGT2J"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=5720&min_rtt=3931&rtt_var=2752&sent=3&recv=5&lost=0&retrans=0&sent_bytes=234&recv_bytes=1209&delivery_rate=342915&cwnd=250&unsent_bytes=0&cid=7d18e8bd83b0182f&ts=626&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 1010
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 1010 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.002206 = 23 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 23 points. Balance: 2125 → 2102
🔥 [STREAM] Sending balance update to frontend: 2102
🔍 ensureConversationExists called with: {
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  difyConversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "nihao",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "conversation_id": "836f4898-d32a-4173-8bf9-beeead7ae6f5",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🔍 Looking up conversation in database: 836f4898-d32a-4173-8bf9-beeead7ae6f5
✅ Found existing DIFY conversation: 836f4898-d32a-4173-8bf9-beeead7ae6f5
🔄 Continuing existing conversation: 836f4898-d32a-4173-8bf9-beeead7ae6f5
📤 [DIFY API] Sending request to chat-messages: {
  query: 'nihao...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  timestamp: '2025-08-31T03:33:42.183Z'
}
📊 Context check: 49 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '977977cdbde9e7d1-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sun, 31 Aug 2025 03:33:43 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=s5p5s0GstV%2B8H5JNRAB8Ow5UQMQKJp7IIbtW3JShnkE2X4J8noyuxscu9dC4QbB0s6V9llJUZRT3cMiR8uNGKx7mAu%2F3nKE7UA%2F7T59P6YhlP0f4TseF2sze%2BAEPLlkLzVyvUWiL9lJO"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=3945&min_rtt=3677&rtt_var=1570&sent=3&recv=5&lost=0&retrans=0&sent_bytes=234&recv_bytes=1209&delivery_rate=366603&cwnd=250&unsent_bytes=0&cid=5f9ef79dafc58e67&ts=399&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 1045
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 1045 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.002276 = 23 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 23 points. Balance: 2074 → 2051
🔥 [STREAM] Sending balance update to frontend: 2051
🔍 ensureConversationExists called with: {
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  difyConversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "你好",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "conversation_id": "836f4898-d32a-4173-8bf9-beeead7ae6f5",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🔍 Looking up conversation in database: 836f4898-d32a-4173-8bf9-beeead7ae6f5
✅ Found existing DIFY conversation: 836f4898-d32a-4173-8bf9-beeead7ae6f5
🔄 Continuing existing conversation: 836f4898-d32a-4173-8bf9-beeead7ae6f5
📤 [DIFY API] Sending request to chat-messages: {
  query: '你好...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  timestamp: '2025-08-31T03:40:41.088Z'
}
📊 Context check: 66 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '97798207e8f35c0d-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sun, 31 Aug 2025 03:40:42 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=IZO4q%2FTMUURzNKHAqTC1fdSygrhy%2FOiaoFAZMt1vvF3quml58DWgPxMTFBqmmK0eAfx%2F%2B6QH4U5Tl%2FjFjWyLpMRXjDR4COf49BemwbM6cYqH5WqyryZohhmR%2B5q3aH2h82wKEtNMTE3U"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=3943&min_rtt=3808&rtt_var=1525&sent=3&recv=5&lost=0&retrans=0&sent_bytes=234&recv_bytes=1210&delivery_rate=353991&cwnd=250&unsent_bytes=0&cid=281e33712d53f83a&ts=974&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 1079
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 1079 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.002344 = 24 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 24 points. Balance: 2023 → 1999
🔥 [STREAM] Sending balance update to frontend: 1999
🔍 ensureConversationExists called with: {
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  difyConversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "你好",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "conversation_id": "836f4898-d32a-4173-8bf9-beeead7ae6f5",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🔍 Looking up conversation in database: 836f4898-d32a-4173-8bf9-beeead7ae6f5
✅ Found existing DIFY conversation: 836f4898-d32a-4173-8bf9-beeead7ae6f5
🔄 Continuing existing conversation: 836f4898-d32a-4173-8bf9-beeead7ae6f5
📤 [DIFY API] Sending request to chat-messages: {
  query: '你好...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  timestamp: '2025-08-31T03:40:51.976Z'
}
📊 Context check: 83 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '9779824d2a316a54-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sun, 31 Aug 2025 03:40:53 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=MZOj4LJGIshNQZO21ZQGPCTXR%2FCnuPpYBIZsygZIsnDoTHawBE0vi8Blp%2FCisIF5am8YBq8TBefoEAxBe%2FPEf1zn%2FYbS%2FPdQT2WWjH5X9U8llhnptSxFzFhzL9ai5kfrbkKEeRqQTWJb"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=3867&min_rtt=3155&rtt_var=1692&sent=3&recv=5&lost=0&retrans=0&sent_bytes=234&recv_bytes=1210&delivery_rate=427258&cwnd=250&unsent_bytes=0&cid=6429da178b7da90a&ts=649&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 1113
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 1113 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.002412 = 25 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 25 points. Balance: 1970 → 1945
🔥 [STREAM] Sending balance update to frontend: 1945
🔍 ensureConversationExists called with: {
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  difyConversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "你好",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "conversation_id": "836f4898-d32a-4173-8bf9-beeead7ae6f5",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🔍 Looking up conversation in database: 836f4898-d32a-4173-8bf9-beeead7ae6f5
✅ Found existing DIFY conversation: 836f4898-d32a-4173-8bf9-beeead7ae6f5
🔄 Continuing existing conversation: 836f4898-d32a-4173-8bf9-beeead7ae6f5
📤 [DIFY API] Sending request to chat-messages: {
  query: '你好...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  timestamp: '2025-08-31T03:41:03.332Z'
}
📊 Context check: 100 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '97798292cfbd77f8-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sun, 31 Aug 2025 03:41:04 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=rrhcHRd4Hzyi5T6CCFKY7eud0xbAgtabRPeAIejj26gvR9krNbAA%2Fg%2BH3KQjM0MNpHCUqGe0veTqLdPVvh997p1%2BIVqTXK4rgqA%2BMRt5pYl%2FbSzIkOMvynwIr9sm72M0hCqgBIPBuxy2"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=3964&min_rtt=3829&rtt_var=1532&sent=3&recv=5&lost=0&retrans=0&sent_bytes=234&recv_bytes=1210&delivery_rate=352050&cwnd=239&unsent_bytes=0&cid=442ec38f1fd8c13a&ts=645&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 1147
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 1147 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.002480 = 25 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 25 points. Balance: 1915 → 1890
🔥 [STREAM] Sending balance update to frontend: 1890
🔍 ensureConversationExists called with: {
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  difyConversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "你好",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "conversation_id": "836f4898-d32a-4173-8bf9-beeead7ae6f5",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🔍 Looking up conversation in database: 836f4898-d32a-4173-8bf9-beeead7ae6f5
✅ Found existing DIFY conversation: 836f4898-d32a-4173-8bf9-beeead7ae6f5
🔄 Continuing existing conversation: 836f4898-d32a-4173-8bf9-beeead7ae6f5
📤 [DIFY API] Sending request to chat-messages: {
  query: '你好...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  timestamp: '2025-08-31T03:41:14.397Z'
}
📊 Context check: 117 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '977982d80d5b57d5-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sun, 31 Aug 2025 03:41:15 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=Wyf14Z17%2BZhPJkKNQtuM%2BfUzcCc6IyACMhEIbt01qteAmFP1I8QDdBP6%2FNS%2BuRMYIT6VTb8OwUAVH4ud741Nu6Bx6QbNNwBxenNYqkqzLtSThnlVy2uBxRn42jZRQK7nBwkUPM%2F2Twye"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=4100&min_rtt=3987&rtt_var=1722&sent=3&recv=5&lost=0&retrans=0&sent_bytes=234&recv_bytes=1210&delivery_rate=275270&cwnd=250&unsent_bytes=0&cid=6e6d7397c87cadd0&ts=652&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 1181
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 1181 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.002548 = 26 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 26 points. Balance: 1890 → 1864
🔥 [STREAM] Sending balance update to frontend: 1864
🔍 ensureConversationExists called with: {
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  difyConversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "你哈",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "conversation_id": "836f4898-d32a-4173-8bf9-beeead7ae6f5",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🔍 Looking up conversation in database: 836f4898-d32a-4173-8bf9-beeead7ae6f5
✅ Found existing DIFY conversation: 836f4898-d32a-4173-8bf9-beeead7ae6f5
🔄 Continuing existing conversation: 836f4898-d32a-4173-8bf9-beeead7ae6f5
📤 [DIFY API] Sending request to chat-messages: {
  query: '你哈...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  timestamp: '2025-08-31T03:48:28.167Z'
}
📊 Context check: 134 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '97798d6f49fda974-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sun, 31 Aug 2025 03:48:29 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=hNJz0%2B95zxTji77KPwKOU2xxie7zCoX1zgFXnz2WufnvZVinl7wkUeRb51ZVVipn0HxelrmvhHEOrCTVEabVO%2BJWy2sY7fxJEtuveEG31MNXWDtMte9XmpEUs1c8RZ0%2FCWE9jY6MN%2FCb"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=4833&min_rtt=3971&rtt_var=2105&sent=3&recv=5&lost=0&retrans=0&sent_bytes=234&recv_bytes=1210&delivery_rate=339461&cwnd=250&unsent_bytes=0&cid=86d7f893cfaf1685&ts=1136&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 1216
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 1216 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.002618 = 27 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 27 points. Balance: 1864 → 1837
🔥 [STREAM] Sending balance update to frontend: 1837
🔍 ensureConversationExists called with: {
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  difyConversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "你好",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "conversation_id": "836f4898-d32a-4173-8bf9-beeead7ae6f5",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🔍 Looking up conversation in database: 836f4898-d32a-4173-8bf9-beeead7ae6f5
✅ Found existing DIFY conversation: 836f4898-d32a-4173-8bf9-beeead7ae6f5
🔄 Continuing existing conversation: 836f4898-d32a-4173-8bf9-beeead7ae6f5
📤 [DIFY API] Sending request to chat-messages: {
  query: '你好...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  timestamp: '2025-08-31T03:48:38.363Z'
}
📊 Context check: 151 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '97798daedcf2e7ed-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sun, 31 Aug 2025 03:48:39 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=8CI8%2Fi%2F650hIzLxDcSccy%2Bze3kQ68m341anKrphZiF1M1VSpDZMs1svIayEO67kYwpNGhZDqzkorL4Xlc6kJKivLi2zgsNRiRmcLl6uXHDIAfZ4b8lYdOU9zmZrBJ7nBGZm%2FAVfeby3q"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=3965&min_rtt=3934&rtt_var=1497&sent=3&recv=5&lost=0&retrans=0&sent_bytes=234&recv_bytes=1210&delivery_rate=342653&cwnd=250&unsent_bytes=0&cid=0f2bd441f14c53c6&ts=622&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 1250
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 1250 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.002686 = 27 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 27 points. Balance: 1804 → 1777
🔥 [STREAM] Sending balance update to frontend: 1777
🔍 ensureConversationExists called with: {
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  difyConversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "那",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "conversation_id": "836f4898-d32a-4173-8bf9-beeead7ae6f5",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🔍 Looking up conversation in database: 836f4898-d32a-4173-8bf9-beeead7ae6f5
✅ Found existing DIFY conversation: 836f4898-d32a-4173-8bf9-beeead7ae6f5
🔄 Continuing existing conversation: 836f4898-d32a-4173-8bf9-beeead7ae6f5
📤 [DIFY API] Sending request to chat-messages: {
  query: '那...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  timestamp: '2025-08-31T03:48:44.816Z'
}
📊 Context check: 167 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '97798dd72f89e7ed-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sun, 31 Aug 2025 03:48:45 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=zB4SdlKvX7jhoxrkKfuBZUqsiYKCuvm6nVFcC2lOkMqaHe46LVV8v1hldQR9ezwXlf07eDVM75kYBNj71DoC%2FyCaA71lympwwtYnsNT4Gu%2FgPybWcAQ7nAr5k9RduAoaDT6Bt35uuUwI"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=113449&min_rtt=3934&rtt_var=46003&sent=69&recv=36&lost=0&retrans=2&sent_bytes=42528&recv_bytes=1682&delivery_rate=342653&cwnd=257&unsent_bytes=0&cid=0f2bd441f14c53c6&ts=6852&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 1284
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 1284 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.002754 = 28 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 28 points. Balance: 1743 → 1715
🔥 [STREAM] Sending balance update to frontend: 1715
🔍 ensureConversationExists called with: {
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  difyConversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "看了",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "conversation_id": "836f4898-d32a-4173-8bf9-beeead7ae6f5",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🔍 Looking up conversation in database: 836f4898-d32a-4173-8bf9-beeead7ae6f5
✅ Found existing DIFY conversation: 836f4898-d32a-4173-8bf9-beeead7ae6f5
🔄 Continuing existing conversation: 836f4898-d32a-4173-8bf9-beeead7ae6f5
📤 [DIFY API] Sending request to chat-messages: {
  query: '看了...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  timestamp: '2025-08-31T03:48:52.640Z'
}
📊 Context check: 184 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '97798e083b3fa94a-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sun, 31 Aug 2025 03:48:53 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=iyBwS1oWyDvWfX4EbsKZdu5sjcsdVATLUfZwulV%2FXBG1Tn3lLkByaT9Er0O50vQ%2F1BY2JEcZIPcrbonw0%2FQk3%2BANp2gK6LM8MrpEBcysdXgbBjQvN5%2BcTWpR2LDZonwZ8K0Z1EuP3mlC"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=5855&min_rtt=4416&rtt_var=2684&sent=3&recv=5&lost=0&retrans=0&sent_bytes=234&recv_bytes=1210&delivery_rate=305253&cwnd=250&unsent_bytes=0&cid=253d0635759d24de&ts=425&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 1319
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 1319 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.002824 = 29 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 29 points. Balance: 1715 → 1686
🔥 [STREAM] Sending balance update to frontend: 1686
🔍 ensureConversationExists called with: {
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  difyConversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "j",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "conversation_id": "836f4898-d32a-4173-8bf9-beeead7ae6f5",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🔍 Looking up conversation in database: 836f4898-d32a-4173-8bf9-beeead7ae6f5
✅ Found existing DIFY conversation: 836f4898-d32a-4173-8bf9-beeead7ae6f5
🔄 Continuing existing conversation: 836f4898-d32a-4173-8bf9-beeead7ae6f5
📤 [DIFY API] Sending request to chat-messages: {
  query: 'j...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  timestamp: '2025-08-31T03:49:35.995Z'
}
📊 Context check: 199 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '97798f179a07a7ad-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sun, 31 Aug 2025 03:49:37 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=uJJr69nqjupwkDhveKG2nWgWHx9IDdLZTG6fTQ%2FlOmqwV0oeBbAvYDvwY9pRCDeEeQPe05lD1hLwCdc5QcZTlzfqxxnvce%2BFyrZMk3ZInXDraC2RqCbk8GdZJAwc1%2BHMJcjiFz3n9irj"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=3976&min_rtt=3973&rtt_var=1497&sent=3&recv=5&lost=0&retrans=0&sent_bytes=234&recv_bytes=1205&delivery_rate=336915&cwnd=248&unsent_bytes=0&cid=0b69b3a4216af16b&ts=744&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 1353
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 1353 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.002892 = 29 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 29 points. Balance: 1686 → 1657
🔥 [STREAM] Sending balance update to frontend: 1657
🔍 ensureConversationExists called with: {
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  difyConversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "nk",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "conversation_id": "836f4898-d32a-4173-8bf9-beeead7ae6f5",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🔍 Looking up conversation in database: 836f4898-d32a-4173-8bf9-beeead7ae6f5
✅ Found existing DIFY conversation: 836f4898-d32a-4173-8bf9-beeead7ae6f5
🔄 Continuing existing conversation: 836f4898-d32a-4173-8bf9-beeead7ae6f5
📤 [DIFY API] Sending request to chat-messages: {
  query: 'nk...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  timestamp: '2025-08-31T03:49:45.525Z'
}
📊 Context check: 214 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '97798f529c7baae4-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sun, 31 Aug 2025 03:49:46 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=Om2tev%2FWEUwaO5XBJsFQkH%2BmBxdZcfrIoNBmHi7Bh%2B4YPBN5W9VOTwwopViKSzhkUry2Np2ha7s4v9KNARw8YArG%2B8u67VsRDRrgarCiJzstH7uIpU5kXlqFm42ROREwqeVeXIUaJxcB"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=4000&min_rtt=3524&rtt_var=1662&sent=5&recv=5&lost=0&retrans=0&sent_bytes=2826&recv_bytes=935&delivery_rate=1147559&cwnd=248&unsent_bytes=0&cid=95dd089a32158f7b&ts=657&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 1387
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 1387 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.002960 = 30 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 30 points. Balance: 1621 → 1591
🔥 [STREAM] Sending balance update to frontend: 1591
🔍 ensureConversationExists called with: {
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  difyConversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "n, axa",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "conversation_id": "836f4898-d32a-4173-8bf9-beeead7ae6f5",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🔍 Looking up conversation in database: 836f4898-d32a-4173-8bf9-beeead7ae6f5
✅ Found existing DIFY conversation: 836f4898-d32a-4173-8bf9-beeead7ae6f5
🔄 Continuing existing conversation: 836f4898-d32a-4173-8bf9-beeead7ae6f5
📤 [DIFY API] Sending request to chat-messages: {
  query: 'n, axa...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  timestamp: '2025-08-31T03:49:54.681Z'
}
📊 Context check: 230 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '97798f8bfa41d5e2-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sun, 31 Aug 2025 03:49:55 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=VTtH0BEwelBdvTbsbjHHF5B4kTjCWpQUrJ%2F3y7nMurShUtCmPqtjpPDRWa2ungXN9%2FnKHyEoqVtvqt3PGkLX3tI8qFpv123dSOsXH7BunGYdhBydj60va7KKc7B8xE881g410jz41A9L"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=4946&min_rtt=4941&rtt_var=1863&sent=3&recv=5&lost=0&retrans=0&sent_bytes=234&recv_bytes=1210&delivery_rate=270574&cwnd=247&unsent_bytes=0&cid=9512c9fd54575af6&ts=635&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 1424
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 1424 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.003034 = 31 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 31 points. Balance: 1591 → 1560
🔥 [STREAM] Sending balance update to frontend: 1560
🔍 ensureConversationExists called with: {
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  difyConversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "你好",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "conversation_id": "836f4898-d32a-4173-8bf9-beeead7ae6f5",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🔍 Looking up conversation in database: 836f4898-d32a-4173-8bf9-beeead7ae6f5
✅ Found existing DIFY conversation: 836f4898-d32a-4173-8bf9-beeead7ae6f5
🔄 Continuing existing conversation: 836f4898-d32a-4173-8bf9-beeead7ae6f5
📤 [DIFY API] Sending request to chat-messages: {
  query: '你好...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  timestamp: '2025-08-31T04:01:23.531Z'
}
📊 Context check: 247 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '9779a05e8e6d572c-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sun, 31 Aug 2025 04:01:25 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=3E0jJ8IejuRI%2F8yMDqSUJqeRxV9af7JbcRY7mlYzx%2BRukBoPsiL%2FfJs69W%2BPGCON067ck9TbDKuuVq%2BIGKc%2FPuM%2Facqi6KZM5CMeiifBzG%2Bp9R6kxKreOZWTbfk%2Fh%2F6UhrQfqtsccDKQ"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=2979&min_rtt=2926&rtt_var=1135&sent=3&recv=5&lost=0&retrans=0&sent_bytes=234&recv_bytes=1210&delivery_rate=460697&cwnd=250&unsent_bytes=0&cid=8e5a5c7dbbab946e&ts=1066&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 1458
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 1458 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.003102 = 32 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 32 points. Balance: 1560 → 1528
🔥 [STREAM] Sending balance update to frontend: 1528
🔍 ensureConversationExists called with: {
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  difyConversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "你好",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "conversation_id": "836f4898-d32a-4173-8bf9-beeead7ae6f5",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🔍 Looking up conversation in database: 836f4898-d32a-4173-8bf9-beeead7ae6f5
✅ Found existing DIFY conversation: 836f4898-d32a-4173-8bf9-beeead7ae6f5
🔄 Continuing existing conversation: 836f4898-d32a-4173-8bf9-beeead7ae6f5
📤 [DIFY API] Sending request to chat-messages: {
  query: '你好...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  timestamp: '2025-08-31T04:01:31.894Z'
}
📊 Context check: 264 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '9779a0905ec35721-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sun, 31 Aug 2025 04:01:32 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=m%2BBdlrh%2BS%2FcFhyI7gwJo51VGUmtz8L204j5X%2BpVYtJePZZJj22wwE0lLGBpqdUknTXB%2FIToUiw4FB8XiKmHJBWUkVrH%2BmM%2FwlazLxMBu03y8K8yKgyAV8HfsWkc70UvW2buC8wZDRTuf"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=5002&min_rtt=4971&rtt_var=1928&sent=3&recv=5&lost=0&retrans=0&sent_bytes=234&recv_bytes=1210&delivery_rate=257941&cwnd=250&unsent_bytes=0&cid=3ec74ec12447f7a9&ts=705&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 1492
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 1492 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.003170 = 32 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 32 points. Balance: 1489 → 1457
🔥 [STREAM] Sending balance update to frontend: 1457
🔍 ensureConversationExists called with: {
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  difyConversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Messages saved successfully
✅ Saved streaming conversation to database
🔍 INCOMING REQUEST: POST /api/dify
🗣️ GENERIC /api/dify ENDPOINT CALLED
📊 Streaming mode: body=true, query=false, final=true
🔍 Full request body: {
  "query": "你好",
  "user": "9dee4891-89a6-44ee-8fe8-69097846e97d",
  "conversation_id": "836f4898-d32a-4173-8bf9-beeead7ae6f5",
  "response_mode": "streaming",
  "stream": true,
  "auto_generate_name": true,
  "inputs": {}
}
🔍 Looking up conversation in database: 836f4898-d32a-4173-8bf9-beeead7ae6f5
✅ Found existing DIFY conversation: 836f4898-d32a-4173-8bf9-beeead7ae6f5
🔄 Continuing existing conversation: 836f4898-d32a-4173-8bf9-beeead7ae6f5
📤 [DIFY API] Sending request to chat-messages: {
  query: '你好...',
  inputs: {},
  response_mode: 'streaming',
  user: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  conversation_id: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  timestamp: '2025-08-31T04:01:42.688Z'
}
📊 Context check: 281 tokens, within limit
📋 Preparing request for DIFY chatflow processing...
[Server Generic] 🔍 Dify API 响应头: {
  'access-control-allow-origin': '*',
  'cf-cache-status': 'DYNAMIC',
  'cf-ray': '9779a0d3abbee7c0-SYD',
  connection: 'keep-alive',
  'content-type': 'text/event-stream; charset=utf-8',
  date: 'Sun, 31 Aug 2025 04:01:43 GMT',
  nel: '{"success_fraction":0,"report_to":"cf-nel","max_age":604800}',
  'report-to': '{"endpoints":[{"url":"https:\\/\\/a.nel.cloudflare.com\\/report\\/v4?s=afi5VN4hXwgO0B1BV6kavLXpgsU3iC%2F6yeXHoVv7UQOvX0b9SlXmG5y7pzwfa59tZOzc9zWaF3MrRnQ%2BkvWDuU%2FbMXJ7ueJoRDOLmlaL3rNA%2B%2FcLE%2FvhVzj3UIdp9x3bHhufrKmAbQFR"}],"group":"cf-nel","max_age":604800}',
  server: 'cloudflare',
  'server-timing': 'cfL4;desc="?proto=TCP&rtt=3957&min_rtt=3957&rtt_var=1485&sent=3&recv=5&lost=0&retrans=0&sent_bytes=234&recv_bytes=1210&delivery_rate=340318&cwnd=250&unsent_bytes=0&cid=d10e7e13cdfd22e0&ts=484&x=0"',
  'strict-transport-security': 'max-age=31536000; includeSubDomains',
  'transfer-encoding': 'chunked',
  'x-content-type-options': 'nosniff',
  'x-env': 'PRODUCTION',
  'x-frame-options': 'DENY',
  'x-version': '1.7.2'
}
[Server Generic] 响应头元数据检查: {
  'x-usage-input-tokens': null,
  'x-usage-output-tokens': null,
  'x-dify-model': null,
  'x-dify-request-id': null,
  hasTokenStats: false,
  hasModelInfo: false
}
🔄 Handling streaming response from Dify API
📤 Forwarded streaming data: {
  event: 'workflow_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: true,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'message',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_started',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'node_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'parallel_branch_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
📤 Forwarded streaming data: {
  event: 'workflow_finished',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: false
}
[Server] 📊 从响应体提取usage信息 (含价格): token统计和价格数据已获取
📤 Forwarded streaming data: {
  event: 'message_end',
  hasAnswer: false,
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  hasUsage: true
}
[Server] 📡 Stream读取完成 - checking for pending usage data
[Server] 📊 结合响应头和响应体数据准备发送混合token使用信息
[Server] ⚠️ 仅使用响应体usage信息
[Server] ✅ 混合token使用信息已发送到前端
🔍 [DEBUG] finalData structure for billing: {
  hasFinalData: true,
  hasMetadata: true,
  hasUsage: true,
  hasTokens: true,
  tokensValue: 1526
}
💰 [BILLING-WORKFLOW_STREAM] Multi-node LLM: 1526 tokens
💰 [COST-WORKFLOW_STREAM] Actual cost: $0.003238 = 33 points
✅ [BILLING-WORKFLOW_STREAM] Deducted 33 points. Balance: 1457 → 1424
🔥 [STREAM] Sending balance update to frontend: 1424
🔍 ensureConversationExists called with: {
  conversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  difyConversationId: '836f4898-d32a-4173-8bf9-beeead7ae6f5',
  userId: '9dee4891-89a6-44ee-8fe8-69097846e97d',
  hasSupabase: true
}
✅ Messages saved successfully
✅ Saved streaming conversation to database
